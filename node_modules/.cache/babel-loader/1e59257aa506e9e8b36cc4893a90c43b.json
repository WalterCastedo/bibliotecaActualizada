{"ast":null,"code":"import axios from \"axios\";\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\nimport { jsPDF } from \"jspdf\";\nimport \"jspdf-autotable\";\nexport default {\n  name: \"ListarEmpleados\",\n\n  data() {\n    return {\n      idAdmin: localStorage.getItem('id'),\n      totalEmpleados: [],\n      nombreEmpleado: \"\",\n      empleados: [],\n      elementosPorPagina: 10,\n      datosPaginados: [],\n      paginaActual: 1,\n      empleadoEditar: {\n        nombre: \"\",\n        id: 0,\n        cargo: '',\n        usuario: '',\n        password: '',\n        password2: '',\n        idSubsede: ''\n      },\n      NombreSubSede: []\n    };\n  },\n\n  created: function () {\n    this.consultarEmpleados();\n  },\n\n  mounted() {\n    this.ObtenerDatosPag(1);\n  },\n\n  methods: {\n    consultarEmpleados() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/empleados\").then(respuesta => respuesta.json()).then(datosRespuesta => {\n        this.empleados = datosRespuesta;\n      }).then(() => {\n        for (let index = 0; index < this.empleados.length; index++) {\n          this.asignarNombre(this.empleados[index].idSubsede, this.empleados[index].id);\n        }\n      }).catch(console.log);\n    },\n\n    asignarNombre(idSubsede, index) {\n      if (this.NombreSubSede[index] == undefined) {\n        fetch(RUTA_SERVIDOR_ALUMNOS + \"/subsede/\" + idSubsede).then(respuesta => respuesta.json()).then(datosRespuesta => {\n          this.filtrarAdmin();\n          this.NombreSubSede[index] = '' + datosRespuesta[0].subsede;\n        });\n      } else {\n        return;\n      }\n    },\n\n    filtrarAdmin() {\n      if (this.estado == -1) {\n        this.totalEmpleados = this.solicitudes;\n        this.ObtenerDatosPag(1);\n      } else {\n        this.totalEmpleados = [];\n\n        for (let index = 0; index < this.empleados.length; index++) {\n          if (this.empleados[index].activo === 1 && this.empleados[index].nombre.toUpperCase().includes(this.nombreEmpleado.toUpperCase())) {\n            this.totalEmpleados = this.totalEmpleados.concat(this.empleados[index]);\n            this.ObtenerDatosPag(1);\n          }\n        }\n\n        if (this.totalEmpleados.length === 0) {\n          this.paginaPrevia(); //this.paginaActual=0;\n        }\n      }\n    },\n\n    eliminar(empleado) {\n      const confirmacion = window.confirm('¿Estás seguro de que deseas eliminar este administrador?');\n\n      if (confirmacion) {\n        axios.put(RUTA_SERVIDOR_LIBROS + \"/empleados/\" + empleado.id, {\n          nombre: empleado.nombre,\n          idEmpleado: empleado.idEmpleado,\n          activo: 0,\n          usuario: empleado.usuario,\n          cargo: empleado.cargo,\n          password: empleado.password,\n          idSubsede: empleado.idSubsede\n        }).then(function (response) {\n          console.log(response);\n          location.reload();\n        }).catch(function (error) {\n          console.log(error); // console.log(this.libro);\n        });\n      }\n    },\n\n    cambiarRegistrosPorPagina() {\n      this.paginaActual = 1;\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    totalPaginas() {\n      if (this.elementosPorPagina === -1) {\n        return 1; // Mostrar todo en una sola página\n      }\n\n      return Math.ceil(this.totalEmpleados.length / this.elementosPorPagina);\n    },\n\n    ObtenerDatosPag(noPag) {\n      this.paginaActual = noPag;\n      this.datosPaginados = [];\n      let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n      let fin = noPag * this.elementosPorPagina;\n      this.datosPaginados = this.totalEmpleados.slice(ini, fin);\n    },\n\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n\n    obtenerAdmin(Admin) {\n      this.empleadoEditar.nombre = Admin.nombre;\n      this.empleadoEditar.id = Admin.id;\n      this.empleadoEditar.usuario = Admin.usuario;\n      this.empleadoEditar.password = Admin.password;\n      this.empleadoEditar.cargo = Admin.cargo;\n      this.empleadoEditar.idSubsede = Admin.idSubsede;\n    },\n\n    actualizar() {\n      if (this.empleadoEditar.nombre.trim() === \"\" || this.empleadoEditar.usuario.trim() === \"\" || this.empleadoEditar.cargo.trim() === \"\" || this.empleadoEditar.password.trim() === \"\" || this.empleadoEditar.password2.trim() === \"\") {\n        alert('Por favor, los campos no pueden estar vacio.');\n        return;\n      }\n\n      if (this.empleadoEditar.password == this.empleadoEditar.password2) {\n        axios.put(RUTA_SERVIDOR_LIBROS + \"/empleados/\" + this.empleadoEditar.id, {\n          nombre: this.empleadoEditar.nombre,\n          idEmpleado: parseInt(localStorage.getItem('id')),\n          activo: 1,\n          usuario: this.empleadoEditar.usuario,\n          cargo: this.empleadoEditar.cargo,\n          password: this.empleadoEditar.password,\n          idSubsede: this.empleadoEditar.idSubsede\n        }).then(function (response) {\n          console.log(response);\n          location.reload();\n        }).then(alert(\"El Administrador se actualizo correctamente\")).catch(function (error) {\n          console.log(error); // console.log(this.libro);\n        });\n      } else {\n        alert('Las contraseñas no coinciden');\n      }\n    },\n\n    exportarAExcel() {\n      // Crear una tabla HTML con los datos que deseas exportar\n      const tabla = document.createElement(\"table\");\n      const thead = tabla.createTHead();\n      const tbody = tabla.createTBody(); // Agregar encabezados de columna a la tabla\n\n      const encabezados = [\"Nombre\", \"Cargo\", \"SubSede\"];\n      const encabezadosRow = thead.insertRow();\n      encabezados.forEach(encabezado => {\n        const th = document.createElement(\"th\");\n        th.innerText = encabezado;\n        encabezadosRow.appendChild(th);\n      }); // Agregar filas de datos a la tabla\n\n      this.datosPaginados.forEach(admin => {\n        const fila = tbody.insertRow();\n        fila.insertCell().innerText = admin.nombre;\n        fila.insertCell().innerText = admin.cargo;\n        fila.insertCell().innerText = this.NombreSubSede[admin.id];\n      }); // Crear un archivo Blob para la tabla HTML\n\n      const blob = new Blob([tabla.outerHTML], {\n        type: \"application/vnd.ms-excel\"\n      }); // Crear un enlace para descargar el archivo Excel\n\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(blob);\n      link.download = \"administradores.xls\"; // Simular un clic en el enlace para iniciar la descarga\n\n      link.click();\n    },\n\n    imprimirAdmin() {\n      // Crear un nuevo documento PDF\n      var doc = new jsPDF(); // Obtener la tabla visible\n\n      var table = document.querySelector('.tableMb'); //titulo\n\n      doc.setFontSize(16);\n      var title = \"Administradores\";\n      var titleWidth = doc.getStringUnitWidth(title) * doc.internal.getFontSize() / doc.internal.scaleFactor;\n      var pageWidth = doc.internal.pageSize.getWidth();\n      var x = (pageWidth - titleWidth) / 2;\n      doc.text(title, x, 10); // Obtener la tabla visible\n\n      var table = document.querySelector('.tableMb'); // Configurar los estilos de la tabla\n\n      var styles = {\n        overflow: 'linebreak',\n        fontSize: 8,\n        // Tamaño de fuente reducido\n        lineWidth: 0.1,\n        lineColor: [0, 0, 0],\n        // Color de las líneas\n        font: 'helvetica',\n        fontStyle: 'normal',\n        halign: 'center',\n        // Alineación horizontal\n        valign: 'middle',\n        // Alineación vertical\n        cellPadding: 2,\n        tableWidth: 'auto',\n        tableBorder: 1,\n        tableLineColor: [0, 0, 0],\n        // Color del borde de la tabla\n        tableFillColor: [255, 255, 255],\n        // Color de fondo de la tabla\n        textColor: 0,\n        cellWidth: 'auto' // Ajustar el ancho de la celda automáticamente\n\n      }; // Ocultar la última columna (Acción) antes de agregar la tabla al documento PDF\n\n      var actionColumn = table.querySelector('th:last-child, td:last-child');\n\n      if (actionColumn) {\n        actionColumn.style.display = 'none';\n      } // Agregar la tabla al documento PDF\n\n\n      doc.autoTable({\n        html: table,\n        startY: 20,\n        styles\n      }); // Mostrar la última columna nuevamente\n\n      if (actionColumn) {\n        actionColumn.style.display = 'table-cell';\n      } // Guardar el PDF\n\n\n      doc.save('administradores.pdf');\n    },\n\n    closeModal() {\n      this.$refs.modalCenter.hide();\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAwKA;AACA;AACA;AACA;AACA;AACA;EACAA,uBADA;;EAEAC;IACA;MACAC,mCADA;MAEAC,kBAFA;MAGAC,kBAHA;MAIAC,aAJA;MAKAC,sBALA;MAMAC,kBANA;MAOAC,eAPA;MAQAC;QACAC,UADA;QAEAC,KAFA;QAGAC,SAHA;QAIAC,WAJA;QAKAC,YALA;QAMAC,aANA;QAOAC;MAPA,CARA;MAiBAC;IAjBA;EAmBA,CAtBA;;EAwBAC;IACA;EACA,CA1BA;;EA2BAC;IACA;EACA,CA7BA;;EA8BAC;IACAC;MACAC,2CACAC,IADA,CACAC,6BADA,EAEAD,IAFA,CAEAE;QAEA;MACA,CALA,EAMAF,IANA,CAMA;QACA;UACA;QAEA;MACA,CAXA,EAYAG,KAZA,CAYAC,WAZA;IAaA,CAfA;;IAiBAC;MAEA;QAEAN,uDACAC,IADA,CACAC,6BADA,EAEAD,IAFA,CAEAE;UACA;UACA;QAEA,CANA;MAOA,CATA,MAUA;QACA;MACA;IACA,CAhCA;;IAkCAI;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;;QACA;UACA,IACA,sCACA,6BACAC,WADA,GAEAC,QAFA,CAEA,iCAFA,CAFA,EAKA;YACA;YACA;UACA;QACA;;QACA;UACA,oBADA,CAEA;QACA;MACA;IACA,CAxDA;;IA0DAC;MACA,oCACA,0DADA;;MAIA;QACAC,MACAC,GADA,CACAC,kDADA,EACA;UACAzB,uBADA;UAEA0B,+BAFA;UAGAC,SAHA;UAIAxB,yBAJA;UAKAD,qBALA;UAMAE,2BANA;UAOAE;QAPA,CADA,EAUAO,IAVA,CAUA;UACAI;UACAW;QACA,CAbA,EAcAZ,KAdA,CAcA;UACAC,mBADA,CAEA;QACA,CAjBA;MAiBA;IACA,CAlFA;;IAoFAY;MACA;MACA;IACA,CAvFA;;IAwFAC;MACA;QACA,SADA,CACA;MACA;;MACA,iBACA,oDADA;IAGA,CA/FA;;IAgGAC;MACA;MACA;MAGA;MACA;MACA;IAEA,CAzGA;;IA2GAC;MACA;QACA;MACA;;MACA;IACA,CAhHA;;IAiHAC;MACA;QACA;MACA;;MACA;IACA,CAtHA;;IAuHAN;MACA;IACA,CAzHA;;IA4HAO;MACA;MACA;MACA;MACA;MACA;MACA;IAIA,CAtIA;;IAuIAC;MAEA,IACA,4CACA,yCADA,IAEA,uCAFA,IAGA,0CAHA,IAIA,2CALA,EAMA;QACAC;QACA;MAAA;;MACA;QAGAb,MACAC,GADA,CACAC,6DADA,EACA;UACAzB,kCADA;UAEA0B,gDAFA;UAGAC,SAHA;UAIAxB,oCAJA;UAKAD,gCALA;UAMAE,sCANA;UAOAE;QAPA,CADA,EAUAO,IAVA,CAUA;UACAI;UACAW;QACA,CAbA,EAcAf,IAdA,CAcAuB,oDAdA,EAeApB,KAfA,CAeA;UACAC,mBADA,CAEA;QACA,CAlBA;MAmBA,CAtBA,MAuBA;QACAmB;MACA;IACA,CA5KA;;IA+KAC;MACA;MACA;MACA;MACA,kCAJA,CAMA;;MACA,qBACA,QADA,EAEA,OAFA,EAGA,SAHA;MAKA;MACAC;QACA;QACAC;QACAC;MACA,CAJA,EAbA,CAmBA;;MACA;QACA;QAEAC;QACAA;QACAA;MAEA,CAPA,EApBA,CA6BA;;MACA;QACAC;MADA,GA9BA,CAkCA;;MACA;MACAC;MACAA,sCArCA,CAuCA;;MACAA;IACA,CAxNA;;IA0NAC;MACA;MACA,sBAFA,CAIA;;MACA,+CALA,CAMA;;MACAC;MACA;MACA;MACA;MACA;MACAA,uBAZA,CAaA;;MACA,+CAdA,CAgBA;;MACA;QACAC,qBADA;QAEAC,WAFA;QAEA;QACAC,cAHA;QAIAC,oBAJA;QAIA;QACAC,iBALA;QAMAC,mBANA;QAOAC,gBAPA;QAOA;QACAC,gBARA;QAQA;QACAC,cATA;QAUAC,kBAVA;QAWAC,cAXA;QAYAC,yBAZA;QAYA;QACAC,+BAbA;QAaA;QACAC,YAdA;QAeAC,iBAfA,CAeA;;MAfA,EAjBA,CAmCA;;MACA;;MACA;QACAC;MACA,CAvCA,CAyCA;;;MACAhB;QAAAiB;QAAAC;QAAAC;MAAA,GA1CA,CA4CA;;MACA;QACAH;MACA,CA/CA,CAiDA;;;MACAhB;IACA,CA7QA;;IA8QAoB;MACA;IACA;;EAhRA;AA9BA","names":["name","data","idAdmin","totalEmpleados","nombreEmpleado","empleados","elementosPorPagina","datosPaginados","paginaActual","empleadoEditar","nombre","id","cargo","usuario","password","password2","idSubsede","NombreSubSede","created","mounted","methods","consultarEmpleados","fetch","then","respuesta","datosRespuesta","catch","console","asignarNombre","filtrarAdmin","toUpperCase","includes","eliminar","axios","put","RUTA_SERVIDOR_LIBROS","idEmpleado","activo","location","cambiarRegistrosPorPagina","totalPaginas","ObtenerDatosPag","paginaPrevia","paginaSiguiente","obtenerAdmin","actualizar","alert","exportarAExcel","encabezados","th","encabezadosRow","fila","type","link","imprimirAdmin","doc","overflow","fontSize","lineWidth","lineColor","font","fontStyle","halign","valign","cellPadding","tableWidth","tableBorder","tableLineColor","tableFillColor","textColor","cellWidth","actionColumn","html","startY","styles","closeModal"],"sourceRoot":"src/components","sources":["ListarAdmin.vue"],"sourcesContent":["<template class=\"fondo\">\n  <div class=\"row align-items-center\">\n    <div class=\"col\">\n      <div class=\" align-items-center\">\n        <div class=\"form-group text-center\">\n          <label for=\"\">Ingresa el nombre del administrador</label>\n          <input\n            v-on:keyup=\"filtrarAdmin()\"\n            v-model=\"nombreEmpleado\"\n            type=\"text\"\n            class=\"form-control text-center\"\n            placeholder=\"Nombre del empleado\"\n          />\n        </div>\n        <label>Registros por página</label>\n    <select v-model=\"elementosPorPagina\" @change=\"cambiarRegistrosPorPagina\">\n      <option value=\"5\" selected>5</option>\n      <option value=\"10\">10</option>\n      <option value=\"20\">20</option>\n      <option value=\"999999\">Todos</option>\n    </select>\n    <button\n      type=\"button\"\n      class=\"btn\"\n      @click=\"imprimirAdmin()\"\n    >\n    <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVR4nO2Z22vTcBTH+08UrcpASE1SrQ1ug9i5sU1l4pQpE2XTubeBoOANxSdFUcELClNURGhZH0TFMh+com4Im+iDQ0HmEPVBENKbcfSS3tav/H5j6VYzy1zSVsmBz0M5/NJPT8/v5JfWYjGjROFkWafLzvXojcA4dugq6mK4g4KdhyEw3IV/Q9TOw8VwF3UXvSNUYaB6yYIY9t6G/8QhrF3B5WXt/HldRUdqbJBE64JIjY4gfvcWBqttcM+UZfhLFSkqiVZ9ZY0UlfSUNVpU0pAVGP5yRYpKmrLcybKLKk8fINzV9Bsvt9WhlnVMyw6VXfRPsblxQ2WIBltXIrR9zZy0OCqkolIRWljWFIVZ0fmE2aOiuZl4dTyFO9ZBedGvEvNdQ6i9Rt1UyjO/mks88mHi9H4E6peq+fDe5lnrCfLxbv3H0499bfQuQm6FRCTzdRy5eBSh9lqax2QWqbfDSPi9SL56jlxSQebTBwQ3sTQvH+mcWv/4Hl1PkA93GCcaahPoa1KtbOA7Yp4rqujEmQP5Cu5yY1KOQHlyf5ZocKPd2IFfKCq5FyH77QvivuuaopJoRbT3FHKpJP1Q06JkfaB5OYVcwzDRmPcqojfOIvV6EMikae/NJSof65qq4pZVqujMCHfWGyea+TyG9Md3dDNEelpVKWhV9OY55JQEpDqbKkquE+leTwk0LCvBV18ACkSJSC76Ewm/p8w9qiGaHhullU6/f0PbgpxDaS+WUjS0U6SjR+uNCImHHponxPp6IR/dA8m9OD8Fdjcg0d+HQGOVecyDeXAWzRO+1XxmEhY6nvT42XGgCE16zNESM/R/ijoN+rPBVYTVDLt1XqJmWP4ufgGVhSpkgRcCwgAAAABJRU5ErkJggg==\">  </button> \n     <button\n      type=\"button\"\n      class=\"btn\"\n      @click=\"exportarAExcel()\"\n    >\n    <img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVR4nO2ZW0sUYRjH5xvkRcieRnfNPZhtuTNBalgNaemaRUWQ6a5p2slq14Uyd6edGTpQKBFhRQXiTV0pXnQhEmLuTF/E+h7/eN+VocBK2Tks8v7hf/E+8w48v3kON8NxTExMu1/id61X1NWfoqGhUtc+Tc45DiDo2g8rkieukSXUFKTnjgKIFiVvAjgNIdoB4CSEaBeA7BCErQCyAxC2A8g2QzgCINsI4RiAbBOElQB7n3T/F2JPQVKrFqBpKbMtiNoXfXNVCbATcwxgU6wCBmuhyrRrW2jfs0vgJ07hwMIEPTd/Gqfn2MdRxBey4DOd2D9/8493Di7lUD/VC//YMfivH0d45op7APHFLDypVgQLfRB0FYG7J2liiVUZzZ/vwDN4BLH3I+Z9csc32kEdfTOE6OwQwi8H3F2jDdoFChGe6acJN83fKFdjC4CWr3ka4zNdENaK7rcQTWolD+9wO4Won0ya8a0AiEm1SNw31oHI6xTEkuIuwKEvD+BJt8Gbbit/2ZL6TwBxXaEx/60T9HlIPusigK6i7n4PfMNHEZlNlxN+e/XvAOtK2WQevhURuC3Bm2qls+EKQOzDNZpk5NWgOcQEJrEyZQLU5U4jpJ2nJpspMC6hcbofjdOXaeX4bJdLFSgpCBXPIZg/g8TaI3ONBieTiL4bQXwxR2fid5MVSoaerFf+XicaHl9Ey/JDd2fATnMMYFOsAgZrocrEWshgLVSZWAsZrIWq5xfTdi0Y6gZnlQ7rWo+TEIKhbiRKSrdlAExMTFzV6hfz8wpqDZBppQAAAABJRU5ErkJggg==\">\n    </button>\n<br>\n<nav aria-label=\"Page navigation example\" class=\"pagination-nav\">\n      <ul class=\"pagination\">\n        <li class=\"page-item\" v-on:click=\"paginaPrevia()\">\n          <a class=\"page-link\" href=\"#\">anterior</a>\n        </li>\n        <li\n          v-for=\"paginaE in totalPaginas()\"\n          :key=\"paginaE\"\n          class=\"page-item\"\n          v-bind:class=\"activo(paginaE)\"\n        >\n          <a class=\"page-link\" href=\"#\" v-on:click=\"ObtenerDatosPag(paginaE)\">{{\n            paginaE\n          }}</a>\n        </li>\n        <li class=\"page-item\" v-on:click=\"paginaSiguiente()\">\n          <a class=\"page-link\" href=\"#\">siguiente</a>\n        </li>\n      </ul>\n    </nav>\n        <div class=\" d-md-block table-responsive table-sm small \">\n          <table class=\"table table-striped border text-center tableMb\">\n            <thead>\n              <tr>\n                <!-- <th>ID</th> -->\n                <th>NOMBRE</th>\n                <th>CARGO</th>\n                <th>SUBSEDE</th>\n                <th>ACCIONES</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"admin in datosPaginados\" :key=\"admin.id\">\n                <td>{{ admin.nombre }}</td>\n                <td>{{ admin.cargo }}</td>\n                 <td>{{NombreSubSede[admin.id]}} </td>\n                <td>\n                  <div class=\"btn-group\" role=\"group\" aria-label=\"\">\n                   <div v-if=\"idAdmin==1 || idAdmin==admin.id \" >\n                   <button\n                      v-b-modal.modal-center\n                      @click=\"obtenerAdmin(admin)\"\n                      class=\"btn btn-info\"\n                    >\n                    <font-awesome-icon icon=\"fa-solid fa-pen-to-square\" />\n                    </button>\n                    </div>\n<div v-else>No hay accion disponible</div>\n                    <div v-if=\"idAdmin==1\">\n                    <button\n                      type=\"button\"\n                      @click=\"eliminar(admin)\"\n                      class=\"btn btn-danger\"\n                    >\n                    <font-awesome-icon icon=\"fa-solid fa-trash-can\"  />\n                    </button>\n                    </div>\n                    \n                  </div>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n\n \n\n    <b-modal id=\"modal-center\" ref=\"modalCenter\" centered title=\"Modificar admin\" hide-footer hide-close-button> \n      <template #modal-title>\n    <button @click=\"closeModal\" class=\"btn btn-sm btn-danger close-button\">X</button>\n    <h5 class=\"modal-title\">Modificar Administrador</h5>\n  </template>\n      <div class=\"form-group d-flex flex-column\">\n        <label for=\"\">Nombre del Administrador</label>\n        <input\n          v-model=\"empleadoEditar.nombre\"\n          type=\"text\"\n          name=\"\"\n          id=\"nombre\"\n          class=\"form-control\"\n          placeholder=\"empleadoEditar.nombre\"\n          aria-describedby=\"helpId\"\n        />\n         <label for=\"\">Usuario del Administrador</label>\n        <input\n          v-model=\"empleadoEditar.usuario\"\n          type=\"text\"\n          name=\"\"\n          id=\"usuario\"\n          class=\"form-control\"\n          placeholder=\"empleadoEditar.usuario\"\n          aria-describedby=\"helpId\"\n        />\n         <label for=\"\">Cargo del Administrador</label>\n        <input\n          v-model=\"empleadoEditar.cargo\"\n          type=\"text\"\n          name=\"\"\n          id=\"cargo\"\n          class=\"form-control\"\n          placeholder=\"empleadoEditar.cargo\"\n          aria-describedby=\"helpId\"\n        />\n         <label for=\"\">Contraseña del Administrador</label>\n        <input\n          v-model=\"empleadoEditar.password\"\n          type=\"password\"\n          name=\"password\"\n          id=\"password\"\n          class=\"form-control\"\n          placeholder=\"empleadoEditar.password\"\n          aria-describedby=\"helpId\"\n        />\n         <label for=\"\">Repetir contraseña </label>\n        <input\n          v-model=\"empleadoEditar.password2\"\n          type=\"password\"\n          name=\"password2\"\n          id=\"password2\"\n          class=\"form-control\"\n          placeholder=\"contraseña\"\n          aria-describedby=\"helpId\"\n        />\n        <br>\n        <button class=\"btn align-items-center btn-info\"  @click=\"actualizar()\">Actualizar datos</button>\n      </div>\n    </b-modal>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\nimport { jsPDF } from \"jspdf\";\nimport \"jspdf-autotable\";\nexport default {\n  name: \"ListarEmpleados\",\n  data() {\n    return {\n      idAdmin:localStorage.getItem('id'),\n      totalEmpleados: [],\n      nombreEmpleado: \"\",\n      empleados: [],\n      elementosPorPagina: 10,\n      datosPaginados: [],\n      paginaActual: 1,\n      empleadoEditar: {\n        nombre: \"\",\n        id: 0,\n        cargo:'',\n        usuario:'',\n        password:'',\n        password2:'',\n        idSubsede:'',\n      },\n      NombreSubSede:[],\n    };\n  },\n\n  created: function () {\n    this.consultarEmpleados();\n  },\n  mounted() {\n    this.ObtenerDatosPag(1);\n  },\n  methods: {\n    consultarEmpleados() {\n      fetch(RUTA_SERVIDOR_LIBROS+\"/empleados\")\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          \n            this.empleados = datosRespuesta;\n            })\n             .then(() => {\n           for (let index = 0; index < this.empleados.length; index++) {\n       this.asignarNombre(this.empleados[index].idSubsede,this.empleados[index].id)\n       \n      } \n        })\n        .catch(console.log);\n    },\n\n    asignarNombre(idSubsede,index){\n      \n      if(this.NombreSubSede[index]==undefined){\n       \n      fetch(RUTA_SERVIDOR_ALUMNOS+\"/subsede/\"+idSubsede)\n      .then((respuesta) => respuesta.json(),)\n      .then((datosRespuesta) => {   \n       this.filtrarAdmin();\n       this.NombreSubSede[index]=''+datosRespuesta[0].subsede;\n  \n     })\n      }\n      else{\n      return \n      }\n      },\n\n    filtrarAdmin() {\n      if (this.estado == -1) {\n        this.totalEmpleados = this.solicitudes;\n        this.ObtenerDatosPag(1);\n      } else {\n      this.totalEmpleados = [];\n      for (let index = 0; index < this.empleados.length; index++) {\n        if (\n          this.empleados[index].activo === 1 &&\n          this.empleados[index].nombre\n            .toUpperCase()\n            .includes(this.nombreEmpleado.toUpperCase())\n        ) {\n          this.totalEmpleados = this.totalEmpleados.concat(this.empleados[index]);\n          this.ObtenerDatosPag(1);\n        }\n      }\n      if (this.totalEmpleados.length === 0) {\n        this.paginaPrevia();\n        //this.paginaActual=0;\n      }\n      }\n    },\n\n    eliminar(empleado) {\n      const confirmacion = window.confirm(\n    '¿Estás seguro de que deseas eliminar este administrador?'\n  );\n\n  if (confirmacion) {\n      axios\n        .put(RUTA_SERVIDOR_LIBROS+\"/empleados/\" + empleado.id, {\n          nombre: empleado.nombre,\n          idEmpleado: empleado.idEmpleado,\n          activo: 0,\n          usuario:empleado.usuario,\n          cargo:empleado.cargo,\n          password:empleado.password,\n          idSubsede:empleado.idSubsede\n        })\n        .then(function (response) {\n          console.log(response);\n          location.reload();\n        })\n        .catch(function (error) {\n          console.log(error);\n          // console.log(this.libro);\n        });}\n    },\n\n    cambiarRegistrosPorPagina() {\n      this.paginaActual=1\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    totalPaginas() {\n      if (this.elementosPorPagina === -1) {\n        return 1; // Mostrar todo en una sola página\n      }\n      return Math.ceil(\n        this.totalEmpleados.length / this.elementosPorPagina\n      );\n    },\n    ObtenerDatosPag(noPag) {\n  this.paginaActual = noPag;\n  this.datosPaginados = [];\n\n \n    let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n    let fin = noPag * this.elementosPorPagina;\n    this.datosPaginados = this.totalEmpleados.slice(ini, fin);\n  \n},\n\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n\n\n    obtenerAdmin(Admin) {\n      this.empleadoEditar.nombre = Admin.nombre;\n      this.empleadoEditar.id = Admin.id;\n      this.empleadoEditar.usuario = Admin.usuario;\n      this.empleadoEditar.password = Admin.password;\n      this.empleadoEditar.cargo = Admin.cargo;\n      this.empleadoEditar.idSubsede=Admin.idSubsede;\n\n     \n\n    },\n    actualizar() {\n\n      if (\n        this.empleadoEditar.nombre.trim() === \"\" ||\n        this.empleadoEditar.usuario.trim() === \"\" ||\n        this.empleadoEditar.cargo.trim() === \"\" ||\n        this.empleadoEditar.password.trim() === \"\" ||\n        this.empleadoEditar.password2.trim() === \"\"\n  ) {\n    alert('Por favor, los campos no pueden estar vacio.');\n    return}\n      if(this.empleadoEditar.password==this.empleadoEditar.password2){\n\n    \n      axios\n        .put(RUTA_SERVIDOR_LIBROS+\"/empleados/\" + this.empleadoEditar.id, {\n          nombre: this.empleadoEditar.nombre,\n          idEmpleado: parseInt(localStorage.getItem('id')),\n          activo: 1,\n          usuario:this.empleadoEditar.usuario,\n          cargo:this.empleadoEditar.cargo,\n          password:this.empleadoEditar.password,\n          idSubsede:this.empleadoEditar.idSubsede\n        })\n        .then(function (response) {\n          console.log(response);\n          location.reload();\n        })\n        .then(alert(\"El Administrador se actualizo correctamente\"))\n        .catch(function (error) {\n          console.log(error);\n          // console.log(this.libro);\n        });\n          }\n        else{\n          alert('Las contraseñas no coinciden');\n        }\n    },\n\n\n    exportarAExcel() {\n      // Crear una tabla HTML con los datos que deseas exportar\n      const tabla = document.createElement(\"table\");\n      const thead = tabla.createTHead();\n      const tbody = tabla.createTBody();\n\n      // Agregar encabezados de columna a la tabla\n      const encabezados = [\n        \"Nombre\",\n        \"Cargo\",\n        \"SubSede\",\n      ];\n      const encabezadosRow = thead.insertRow();\n      encabezados.forEach((encabezado) => {\n        const th = document.createElement(\"th\");\n        th.innerText = encabezado;\n        encabezadosRow.appendChild(th);\n      });\n\n      // Agregar filas de datos a la tabla\n      this.datosPaginados.forEach((admin) => {\n        const fila = tbody.insertRow();\n      \n        fila.insertCell().innerText = admin.nombre;\n        fila.insertCell().innerText = admin.cargo;\n        fila.insertCell().innerText = this.NombreSubSede[admin.id]\n        \n      });\n\n      // Crear un archivo Blob para la tabla HTML\n      const blob = new Blob([tabla.outerHTML], {\n        type: \"application/vnd.ms-excel\",\n      });\n\n      // Crear un enlace para descargar el archivo Excel\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(blob);\n      link.download = \"administradores.xls\";\n\n      // Simular un clic en el enlace para iniciar la descarga\n      link.click();\n    },\n\nimprimirAdmin() {\n  // Crear un nuevo documento PDF\n  var doc = new jsPDF();\n\n  // Obtener la tabla visible\n  var table = document.querySelector('.tableMb');\n//titulo\ndoc.setFontSize(16);\n  var title = \"Administradores\";\n  var titleWidth = doc.getStringUnitWidth(title) * doc.internal.getFontSize() / doc.internal.scaleFactor;\n  var pageWidth = doc.internal.pageSize.getWidth();\n  var x = (pageWidth - titleWidth) / 2;\n  doc.text(title, x, 10);\n  // Obtener la tabla visible\n  var table = document.querySelector('.tableMb');\n\n  // Configurar los estilos de la tabla\n  var styles = {\n    overflow: 'linebreak',\n    fontSize: 8, // Tamaño de fuente reducido\n    lineWidth: 0.1,\n    lineColor: [0, 0, 0], // Color de las líneas\n    font: 'helvetica',\n    fontStyle: 'normal',\n    halign: 'center', // Alineación horizontal\n    valign: 'middle', // Alineación vertical\n    cellPadding: 2,\n    tableWidth: 'auto',\n    tableBorder: 1,\n    tableLineColor: [0, 0, 0], // Color del borde de la tabla\n    tableFillColor: [255, 255, 255], // Color de fondo de la tabla\n    textColor: 0,\n    cellWidth: 'auto', // Ajustar el ancho de la celda automáticamente\n  };\n\n  // Ocultar la última columna (Acción) antes de agregar la tabla al documento PDF\n  var actionColumn = table.querySelector('th:last-child, td:last-child');\n  if (actionColumn) {\n    actionColumn.style.display = 'none';\n  }\n\n  // Agregar la tabla al documento PDF\n  doc.autoTable({ html: table, startY: 20, styles });\n\n  // Mostrar la última columna nuevamente\n  if (actionColumn) {\n    actionColumn.style.display = 'table-cell';\n  }\n\n  // Guardar el PDF\n  doc.save('administradores.pdf');\n},\ncloseModal() {\n      this.$refs.modalCenter.hide();\n    },\n\n    \n  }\n};\n</script>\n<style>\n.pagination-nav {\n    max-width: 100%; /* Puedes ajustar este valor según tus necesidades */\n    overflow-x: auto; /* Agrega una barra de desplazamiento horizontal si es necesario */\n}\n</style>"]},"metadata":{},"sourceType":"module"}