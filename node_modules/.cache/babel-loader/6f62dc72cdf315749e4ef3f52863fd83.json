{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n// import { Bar } from 'vue-chartjs'\n// import { Chart as ChartJS,Title, ArcElement, Tooltip, Legend,BarElement, CategoryScale, LinearScale } from 'chart.js'\n// import { Doughnut } from 'vue-chartjs'\n// ChartJS.register(Title, ArcElement, Tooltip, Legend, BarElement, CategoryScale, LinearScale)\n// Import component\nimport Loading from \"vue-loading-overlay\"; // Import stylesheet\n\nimport \"vue-loading-overlay/dist/vue-loading.css\"; // import * as XLSX from 'xlsx'\n\nimport * as saveAs from \"file-saver\";\nimport listar from \"@/views/MaterialesView.vue\";\nimport { jsPDF } from \"jspdf\";\nimport \"jspdf-autotable\"; // import { Carousel, Slide } from 'vue-carousel';\n\nimport modalPrestamo from \"@/components/modalPrestamo.vue\";\nimport axios from \"axios\"; // import CrearLibro from '@/components/CrearLibro.vue'\n\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\nexport default {\n  name: \"ListarMaterial\",\n  components: {\n    // Bar,\n    // Doughnut,\n    modalPrestamo,\n    Loading\n  },\n\n  data() {\n    return {\n      isLoading: true,\n      fullPage: true,\n      dataToExport: [],\n      prestamoMaterial: {\n        id: 0,\n        nombreMaterial: \"\",\n        autor: \"\",\n        editorial: \"\",\n        edicion: \"\",\n        urlPortada: \"\"\n      },\n      tipos: [],\n      subsede: localStorage.getItem(\"idSubsede\"),\n      totalMateriales: [],\n      Materiales: [],\n      autor: [],\n      carreras: [],\n      materia: 1,\n      nombreMaterial: \"\",\n      nombreAutor: 1,\n      editoriales: [],\n      elementosPorPagina: 10,\n      datosPaginados: [],\n      paginaActual: 1,\n      acceso: localStorage.getItem(\"acceso\"),\n      radioPdf: 0\n    };\n  },\n\n  created: async function () {\n    this.consultarAutor();\n    await this.consultarEditorial();\n    this.consultarTipo();\n  },\n\n  async mounted() {\n    await this.consultarCarreras(); // this.consultarCantidad();\n\n    this.ObtenerDatosPag(1);\n  },\n\n  methods: {\n    cambiarRegistrosPorPagina() {\n      this.paginaActual = 1;\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    redireccionaarPdf(pdf) {\n      var a = document.createElement(\"a\");\n      a.target = \"_blank\";\n      a.href = \"http://192.168.0.113:8082/storage/documentos/\" + pdf;\n      a.click();\n    },\n\n    onCancel() {\n      console.log(\"usuario cancelo la carga.\");\n    },\n\n    consultarTipo() {\n      return fetch(RUTA_SERVIDOR_LIBROS + \"/tipos/\").then(respuesta => respuesta.json()).then(datosRespuesta => {\n        if (typeof datosRespuesta[0].success === \"undefined\") {\n          datosRespuesta.sort((a, b) => {\n            if (a.tipo.toUpperCase() == b.tipo.toUpperCase()) {\n              return 0;\n            }\n\n            if (a.tipo.toUpperCase() > b.tipo.toUpperCase()) {\n              return 1;\n            }\n\n            if (a.tipo.toUpperCase() < b.tipo.toUpperCase()) {\n              return -1;\n            }\n          });\n          datosRespuesta.forEach(tipo => {\n            tipo.stado = \"accepted\"; // Puedes establecer el valor inicial como falso\n          });\n          this.tipos = datosRespuesta;\n        }\n      }).catch(console.log);\n    },\n\n    consultarMaterlales() {\n      // Llama a consultarTipo() para obtener los tipos antes de consultar los materiales.\n      return this.consultarTipo().then(() => {\n        return fetch(RUTA_SERVIDOR_LIBROS + \"/materialesSubsede/\" + this.subsede).then(respuesta => respuesta.json()).then(datosRespuesta => {\n          this.Materiales = [];\n\n          if (typeof datosRespuesta[0].success === \"undefined\") {\n            datosRespuesta.sort((a, b) => {\n              if (a.titulo.toUpperCase() == b.titulo.toUpperCase()) {\n                return 0;\n              }\n\n              if (a.titulo.toUpperCase() > b.titulo.toUpperCase()) {\n                return 1;\n              }\n\n              if (a.titulo.toUpperCase() < b.titulo.toUpperCase()) {\n                return -1;\n              }\n            });\n            this.Materiales = datosRespuesta;\n            this.Materiales.forEach(material => {\n              const tipoAsociado = this.tipos.find(tipo => tipo.id == material.idTipomaterial);\n\n              if (tipoAsociado) {\n                material.tipo = tipoAsociado.tipo;\n              }\n            });\n            console.log(this.Materiales);\n\n            for (let index = 0; index < this.Materiales.length; index++) {\n              for (let index2 = 0; index2 < this.autor.length; index2++) {\n                if (this.autor[index2].id == this.Materiales[index].idAutor) {\n                  var nombreAutor = this.autor[index2].nombre;\n                  this.Materiales[index].nombre = nombreAutor;\n                }\n              }\n            }\n\n            this.filtrarMateriales();\n            this.filtrarArchivos();\n          }\n        }).catch(console.log);\n      });\n    },\n\n    filtrarArchivos() {\n      this.dataToExport = [];\n\n      for (let index = 0; index < this.Materiales.length; index++) {\n        if (this.Materiales[index].idCarrera === this.materia && this.Materiales[index].activo === 1 && this.Materiales[index].documento != null && this.radioPdf == 1) {\n          this.dataToExport = this.dataToExport.concat(this.Materiales[index]);\n        } else {\n          if (this.Materiales[index].idCarrera === this.materia && this.Materiales[index].activo === 1 && this.Materiales[index].documento == null && this.radioPdf == 0) {\n            this.dataToExport = this.dataToExport.concat(this.Materiales[index]);\n          }\n        }\n      }\n\n      this.isLoading = false;\n    },\n\n    filtrarMateriales() {\n      this.totalMateriales = [];\n\n      for (let index = 0; index < this.Materiales.length; index++) {\n        if (this.Materiales[index].idCarrera === this.materia && this.Materiales[index].activo === 1 && (this.Materiales[index].titulo.toUpperCase().includes(this.nombreMaterial.toUpperCase()) || this.Materiales[index].nombre.toUpperCase().includes(this.nombreMaterial.toUpperCase())) && this.Materiales[index].documento != null && this.radioPdf == 1) {\n          if (this.tipos.some(tipo => tipo.stado == \"accepted\" && tipo.id == this.Materiales[index].idTipomaterial)) {\n            this.totalMateriales = this.totalMateriales.concat(this.Materiales[index]);\n            this.ObtenerDatosPag(1);\n          }\n        } else {\n          if (this.Materiales[index].idCarrera === this.materia && this.Materiales[index].activo === 1 && (this.Materiales[index].titulo.toUpperCase().includes(this.nombreMaterial.toUpperCase()) || this.Materiales[index].nombre.toUpperCase().includes(this.nombreMaterial.toUpperCase())) && this.Materiales[index].documento == null && this.radioPdf == 0) {\n            if (this.tipos.some(tipo => tipo.stado == \"accepted\" && tipo.id == this.Materiales[index].idTipomaterial)) {\n              this.totalMateriales = this.totalMateriales.concat(this.Materiales[index]);\n              this.ObtenerDatosPag(1);\n            }\n          }\n        }\n      }\n\n      if (this.totalMateriales.length === 0) {\n        this.paginaPrevia(); //this.paginaActual=0;\n      }\n    },\n\n    consultarAutor() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/autor/\").then(respuesta => respuesta.json()).then(datosRespuesta => {\n        this.autor = datosRespuesta;\n        this.consultarMaterlales();\n      }).catch(console.log);\n    },\n\n    consultarEditorial() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/editoriales/\").then(respuesta => respuesta.json()).then(datosRespuesta => {\n        if (typeof datosRespuesta[0].success === \"undefined\") {\n          this.editoriales = datosRespuesta;\n        }\n      }).catch(console.log);\n    },\n\n    Enviar(id) {\n      this.$emit(\"recibiendo\", id);\n      listar.editar();\n    },\n\n    confirmarEliminarSolicitud(material) {\n      if (window.confirm(\"¿Estás seguro de que deseas eliminar este material?\")) {\n        this.eliminar(material);\n      }\n    },\n\n    eliminar(material) {\n      axios.put(RUTA_SERVIDOR_LIBROS + \"/materiales/\" + material.id, {\n        titulo: material.titulo,\n        copias: material.copias,\n        copiasDisponibles: material.copiasDisponibles,\n        idTipomaterial: material.idTipomaterial,\n        edicion: material.edicion,\n        codigo: material.codigo,\n        idAutor: parseInt(material.idAutor),\n        idEmpleado: material.idEmpleado,\n        idEditorial: parseInt(material.idEditorial),\n        idCarrera: parseInt(material.idCarrera),\n        urlPortada: material.urlPortada,\n        observacion: material.observacion,\n        documento: material.documento,\n        activo: 0\n      }).then(function (response) {\n        location.reload();\n      }).catch(function (error) {\n        console.log(error); // console.log(this.material);\n      });\n    },\n\n    obtenerMaterial(id, nombre, autor, editorial, edicion, urlPortada, tipo) {\n      this.prestamoMaterial = {\n        id: id,\n        nombreMaterial: nombre,\n        autor: autor,\n        editorial: editorial,\n        edicion: edicion,\n        urlPortada: urlPortada,\n        tipo: tipo\n      };\n    },\n\n    consultarCarreras() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/carreras\").then(respuesta => respuesta.json()).then(datosRespuesta => {\n        this.carreras = [];\n\n        if (typeof datosRespuesta[0].success === \"undefined\") {\n          this.carreras = datosRespuesta;\n        }\n      }).catch(console.log);\n    },\n\n    consultarCantidad() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/cantidadMateriales/\" + this.subsede).then(respuesta => respuesta.json()).then(datosRespuesta => {\n        if (typeof datosRespuesta[0].success === \"undefined\") {\n          for (let index = 0; index < datosRespuesta[1].length; index++) {\n            this.chartDataL.labels.push(datosRespuesta[1][index][0] + \" : \" + datosRespuesta[1][index][1]);\n            this.chartDataL.datasets[0].data.push(datosRespuesta[1][index][1]);\n            this.totalesL += datosRespuesta[1][index][1];\n            this.totalesD += datosRespuesta[2][index][1];\n            this.dataBar.labels.push(datosRespuesta[1][index][0]);\n            this.dataBar.datasets[0].data.push(datosRespuesta[1][index][1]);\n            this.dataBar.datasets[1].data.push(datosRespuesta[2][index][1]);\n          } // this.data.labels.push(datosRespuesta[1][index][0]+ ' : '+datosRespuesta[1][index][1] )\n\n\n          for (let index = 0; index < datosRespuesta[0].length; index++) {\n            this.chartDataP.labels.push(datosRespuesta[0][index][0] + \" : \" + datosRespuesta[0][index][1]);\n            this.chartDataP.datasets[0].data.push(datosRespuesta[0][index][1]);\n          }\n        }\n\n        this.dataBar.datasets[0].label.push(\"Materiales Totales : \" + this.totalesL);\n        this.dataBar.datasets[1].label.push(\"Materiales Disponibles : \" + this.totalesD);\n      }).catch(console.log);\n    },\n\n    totalPaginas() {\n      if (this.elementosPorPagina === -1) {\n        return 1; // Mostrar todo en una sola página\n      }\n\n      return Math.ceil(this.totalMateriales.length / this.elementosPorPagina);\n    },\n\n    ObtenerDatosPag(noPag) {\n      this.paginaActual = noPag;\n      this.datosPaginados = [];\n      let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n      let fin = noPag * this.elementosPorPagina;\n      this.datosPaginados = this.totalMateriales.slice(ini, fin);\n    },\n\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n\n    precionadoBoton(id) {\n      console.log(id);\n    },\n\n    cambiaC(carrera) {\n      this.materia = carrera;\n      this.filtrarMateriales();\n      this.filtrarArchivos();\n    },\n\n    exportExcel() {\n      const tabla = document.createElement(\"table\");\n      const thead = tabla.createTHead();\n      const tbody = tabla.createTBody(); // Agregar encabezados de columna a la tabla\n\n      const encabezados = [\"Id\", \"Tipo\", \"Titulo\", \"Autor\", \"Editorial\", \"Edicion\", \"Codigo\", \"Copias\", \"Disponibles\"];\n      const encabezadosRow = thead.insertRow();\n      encabezados.forEach(encabezado => {\n        const th = document.createElement(\"th\");\n        th.innerText = encabezado;\n        encabezadosRow.appendChild(th);\n      }); // Agregar filas de datos a la tabla\n\n      this.datosPaginados.forEach(material => {\n        const fila = tbody.insertRow();\n        fila.insertCell().innerText = material.id;\n        fila.insertCell().innerText = material.tipo;\n        fila.insertCell().innerText = material.titulo;\n        fila.insertCell().innerText = material.nombre;\n        fila.insertCell().innerText = this.editoriales[[material.idEditorial] - 1].nombreEditorial, fila.insertCell().innerText = material.edicion;\n        fila.insertCell().innerText = material.codigo;\n        fila.insertCell().innerText = material.copias;\n        fila.insertCell().innerText = material.copiasDisponibles;\n      }); // Crear un archivo Blob para la tabla HTML\n\n      const blob = new Blob([tabla.outerHTML], {\n        type: \"application/vnd.ms-excel\"\n      });\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(blob);\n      link.download = \"Materiales.xls\";\n      link.click();\n    },\n\n    exportPdf() {\n      var doc = new jsPDF(); //titulo\n\n      doc.setFontSize(16);\n      var title = \"Materiales\";\n      var titleWidth = doc.getStringUnitWidth(title) * doc.internal.getFontSize() / doc.internal.scaleFactor;\n      var pageWidth = doc.internal.pageSize.getWidth();\n      var x = (pageWidth - titleWidth) / 2;\n      doc.text(title, x, 10); // Obtener la tabla visible\n\n      var table = document.querySelector(\".tableMb\"); // Obtener la tabla visible\n\n      var table = document.querySelector(\".tableMb\"); // Configurar los estilos de la tabla\n\n      var styles = {\n        overflow: \"linebreak\",\n        fontSize: 8,\n        // Tamaño de fuente reducido\n        lineWidth: 0.1,\n        lineColor: [0, 0, 0],\n        // Color de las líneas\n        font: \"helvetica\",\n        fontStyle: \"normal\",\n        halign: \"center\",\n        // Alineación horizontal\n        valign: \"middle\",\n        // Alineación vertical\n        cellPadding: 2,\n        tableWidth: \"auto\",\n        tableBorder: 1,\n        tableLineColor: [0, 0, 0],\n        // Color del borde de la tabla\n        tableFillColor: [255, 255, 255],\n        // Color de fondo de la tabla\n        textColor: 0,\n        cellWidth: \"auto\" // Ajustar el ancho de la celda automáticamente\n\n      }; // Ocultar la última columna (Acción) antes de agregar la tabla al documento PDF\n\n      var actionColumn = table.querySelector(\"th:last-child, td:last-child\");\n\n      if (actionColumn) {\n        actionColumn.style.display = \"none\";\n      } // Agregar la tabla al documento PDF\n\n\n      doc.autoTable({\n        html: table,\n        startY: 20,\n        styles\n      }); // Mostrar la última columna nuevamente\n\n      if (actionColumn) {\n        actionColumn.style.display = \"table-cell\";\n      } // Guardar el PDF\n\n\n      doc.save(\"Materiales.pdf\");\n    },\n\n    closeModal() {\n      this.$refs.modalCenter.hide();\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["name","components","modalPrestamo","Loading","data","isLoading","fullPage","dataToExport","prestamoMaterial","id","nombreMaterial","autor","editorial","edicion","urlPortada","tipos","subsede","totalMateriales","Materiales","carreras","materia","nombreAutor","editoriales","elementosPorPagina","datosPaginados","paginaActual","acceso","radioPdf","created","methods","cambiarRegistrosPorPagina","redireccionaarPdf","a","onCancel","console","consultarTipo","then","respuesta","datosRespuesta","tipo","catch","consultarMaterlales","RUTA_SERVIDOR_LIBROS","material","filtrarArchivos","filtrarMateriales","toUpperCase","includes","consultarAutor","fetch","consultarEditorial","Enviar","listar","confirmarEliminarSolicitud","window","eliminar","axios","put","titulo","copias","copiasDisponibles","idTipomaterial","codigo","idAutor","idEmpleado","idEditorial","idCarrera","observacion","documento","activo","location","obtenerMaterial","consultarCarreras","consultarCantidad","totalPaginas","ObtenerDatosPag","paginaPrevia","paginaSiguiente","precionadoBoton","cambiaC","exportExcel","encabezados","th","encabezadosRow","fila","type","link","exportPdf","doc","overflow","fontSize","lineWidth","lineColor","font","fontStyle","halign","valign","cellPadding","tableWidth","tableBorder","tableLineColor","tableFillColor","textColor","cellWidth","actionColumn","html","startY","styles","closeModal"],"sourceRoot":"src/components","sources":["ListarMaterial.vue"],"sourcesContent":["<template>\n  \n  <div class=\"align-items-center todoFondo\">\n    <transition name=\"fade\">\n      <div v-if=\"isLoading\" class=\"loading-spinner\">\n        <div class=\"spinner\"></div>\n      </div>\n    </transition>\n      \n    <div class=\"row rowS\">\n      <div class=\"form-group col-sm-4\">\n        <label for=\"\">Titulo / autor</label>\n        <input\n          v-on:keyup=\"filtrarMateriales()\"\n          v-model=\"nombreMaterial\"\n          type=\"text\"\n          class=\"form-control\"\n          placeholder=\"Titulo o Autor\"\n        />\n      </div>\n\n      <div class=\"form-group col-sm-4\">\n        <label>Selecciona una carrera</label>\n        <select\n          v-model=\"materia\"\n          @change=\"cambiaC(materia)\"\n          class=\"form-control\"\n        >\n          <option\n            v-for=\"carrera in carreras\"\n            :key=\"carrera.id\"\n            v-bind:value=\"carrera.id\"\n          >\n            {{ carrera.nombreCarrera }}\n          </option>\n        </select>\n      </div>\n\n      <div class=\"col-sm-2\" @change=\"cambiaC(materia)\">\n        <b-form-group label=\"Formato: \" v-slot=\"{ ariaDescribedby }\">\n          <b-form-radio\n            v-model=\"radioPdf\"\n            :aria-describedby=\"ariaDescribedby\"\n            name=\"some-radios\"\n            value=\"0\"\n            >Material</b-form-radio\n          >\n          <b-form-radio\n            v-model=\"radioPdf\"\n            :aria-describedby=\"ariaDescribedby\"\n            name=\"some-radios\"\n            value=\"1\"\n            >PDF</b-form-radio\n          >\n        </b-form-group>\n      </div>\n\n      <div class=\"col-sm-2\">\n        Tipo:\n        <br/>\n       \n        <b-form-checkbox\n          v-for=\"tipo in tipos\"\n          :key=\"tipo.id\"\n          v-model=\"tipo.stado\"\n          :id=\"`checkbox-${tipo.id}`\"\n          :name=\"`checkbox-${tipo.tipo}`\"\n          value=\"accepted\"\n          unchecked-value=\"not_accepted\"\n          @change=\"filtrarMateriales\"\n        >\n          {{ tipo.tipo }}\n        </b-form-checkbox>\n      </div>\n    </div>\n    <br />\n    <label>Registros por página</label>\n    <select v-model=\"elementosPorPagina\" @change=\"cambiarRegistrosPorPagina\">\n      <option value=\"5\" selected>5</option>\n      <option value=\"10\">10</option>\n      <option value=\"20\">20</option>\n      <option value=\"999999\">Todos</option>\n    </select>\n\n    <button v-if=\"acceso == 2\" type=\"button\" class=\"btn\" @click=\"exportPdf()\">\n      <img\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAACXBIWXMAAAsTAAALEwEAmpwYAAAChklEQVR4nO2Z22vTcBTH+08UrcpASE1SrQ1ug9i5sU1l4pQpE2XTubeBoOANxSdFUcELClNURGhZH0TFMh+com4Im+iDQ0HmEPVBENKbcfSS3tav/H5j6VYzy1zSVsmBz0M5/NJPT8/v5JfWYjGjROFkWafLzvXojcA4dugq6mK4g4KdhyEw3IV/Q9TOw8VwF3UXvSNUYaB6yYIY9t6G/8QhrF3B5WXt/HldRUdqbJBE64JIjY4gfvcWBqttcM+UZfhLFSkqiVZ9ZY0UlfSUNVpU0pAVGP5yRYpKmrLcybKLKk8fINzV9Bsvt9WhlnVMyw6VXfRPsblxQ2WIBltXIrR9zZy0OCqkolIRWljWFIVZ0fmE2aOiuZl4dTyFO9ZBedGvEvNdQ6i9Rt1UyjO/mks88mHi9H4E6peq+fDe5lnrCfLxbv3H0499bfQuQm6FRCTzdRy5eBSh9lqax2QWqbfDSPi9SL56jlxSQebTBwQ3sTQvH+mcWv/4Hl1PkA93GCcaahPoa1KtbOA7Yp4rqujEmQP5Cu5yY1KOQHlyf5ZocKPd2IFfKCq5FyH77QvivuuaopJoRbT3FHKpJP1Q06JkfaB5OYVcwzDRmPcqojfOIvV6EMikae/NJSof65qq4pZVqujMCHfWGyea+TyG9Md3dDNEelpVKWhV9OY55JQEpDqbKkquE+leTwk0LCvBV18ACkSJSC76Ewm/p8w9qiGaHhullU6/f0PbgpxDaS+WUjS0U6SjR+uNCImHHponxPp6IR/dA8m9OD8Fdjcg0d+HQGOVecyDeXAWzRO+1XxmEhY6nvT42XGgCE16zNESM/R/ijoN+rPBVYTVDLt1XqJmWP4ufgGVhSpkgRcCwgAAAABJRU5ErkJggg==\"\n      />\n    </button>\n    <button v-if=\"acceso == 2\" type=\"button\" class=\"btn\" @click=\"exportExcel()\">\n      <img\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTUlEQVR4nO2ZW0sUYRjH5xvkRcieRnfNPZhtuTNBalgNaemaRUWQ6a5p2slq14Uyd6edGTpQKBFhRQXiTV0pXnQhEmLuTF/E+h7/eN+VocBK2Tks8v7hf/E+8w48v3kON8NxTExMu1/id61X1NWfoqGhUtc+Tc45DiDo2g8rkieukSXUFKTnjgKIFiVvAjgNIdoB4CSEaBeA7BCErQCyAxC2A8g2QzgCINsI4RiAbBOElQB7n3T/F2JPQVKrFqBpKbMtiNoXfXNVCbATcwxgU6wCBmuhyrRrW2jfs0vgJ07hwMIEPTd/Gqfn2MdRxBey4DOd2D9/8493Di7lUD/VC//YMfivH0d45op7APHFLDypVgQLfRB0FYG7J2liiVUZzZ/vwDN4BLH3I+Z9csc32kEdfTOE6OwQwi8H3F2jDdoFChGe6acJN83fKFdjC4CWr3ka4zNdENaK7rcQTWolD+9wO4Won0ya8a0AiEm1SNw31oHI6xTEkuIuwKEvD+BJt8Gbbit/2ZL6TwBxXaEx/60T9HlIPusigK6i7n4PfMNHEZlNlxN+e/XvAOtK2WQevhURuC3Bm2qls+EKQOzDNZpk5NWgOcQEJrEyZQLU5U4jpJ2nJpspMC6hcbofjdOXaeX4bJdLFSgpCBXPIZg/g8TaI3ONBieTiL4bQXwxR2fid5MVSoaerFf+XicaHl9Ey/JDd2fATnMMYFOsAgZrocrEWshgLVSZWAsZrIWq5xfTdi0Y6gZnlQ7rWo+TEIKhbiRKSrdlAExMTFzV6hfz8wpqDZBppQAAAABJRU5ErkJggg==\"\n      />\n    </button>\n    <br v-if=\"acceso == 1\" />\n    <br v-if=\"acceso == 1\" />\n    <nav aria-label=\"Page navigation example\" class=\"pagination-nav\">\n      <ul align=\"center\" class=\"pagination\">\n        <li class=\"page-item\" v-on:click=\"paginaPrevia()\">\n          <a class=\"page-link\" href=\"#\">anterior</a>\n        </li>\n        <li\n          v-for=\"pagina in totalPaginas()\"\n          :key=\"pagina\"\n          class=\"page-item\"\n          v-bind:class=\"activo(pagina)\"\n        >\n          <a class=\"page-link\" href=\"#\" v-on:click=\"ObtenerDatosPag(pagina)\">{{\n            pagina\n          }}</a>\n        </li>\n        <li class=\"page-item\" v-on:click=\"paginaSiguiente()\">\n          <a class=\"page-link\" href=\"#\">siguiente</a>\n        </li>\n      </ul>\n    </nav>\n\n    <div class=\"estudiante\" v-if=\"acceso == 1\">\n      <div class=\"carrusel row\">\n        <div\n          align=\"center\"\n          class=\"listado col-6 col-lg-3 col-md-4 col-xl-3\"\n          v-for=\"material in datosPaginados\"\n          :key=\"material.id\"\n        >\n          <div v-if=\"material.documento == null\">\n            <div\n              class=\"icon-container-2\"\n              v-bind:style=\"{\n                backgroundImage: 'url(' + material.urlPortada + ')',\n                backgroundSize: 'cover',\n                backgroundPosition: 'center'\n              }\"\n              v-b-modal.modal-lg\n              @click=\"\n                obtenerMaterial(\n                  material.id,\n                  material.titulo,\n\n                  material.nombre,\n                  editoriales[[material.idEditorial] - 1].nombreEditorial,\n                  material.edicion,\n                  material.urlPortada,\n                  material.tipo\n                )\n              \"\n            >\n              <div v-if=\"acceso == 2\">\n                <div class=\"btn-material-1\">\n                  <div\n                    align=\"center\"\n                    class=\"btn-material\"\n                    @click=\"Enviar(material.id)\"\n                  >\n                    ✍🏻\n                  </div>\n                </div>\n                <div class=\"btn-circle-2\">\n                  <div\n                    v-on:click=\"confirmarEliminarSolicitud(material)\"\n                    class=\"btn-circle\"\n                  >\n                    ❌\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div v-else>\n            <div\n              class=\"icon-container-2\"\n              v-bind:style=\"{\n                backgroundImage: 'url(' + material.urlPortada + ')',\n                backgroundSize: 'cover',\n                backgroundPosition: 'center'\n              }\"\n              @click=\"redireccionaarPdf(material.documento)\"\n            >\n              <div v-if=\"acceso == 2\">\n                <div class=\"btn-material-1\">\n                  <div\n                    align=\"center\"\n                    class=\"btn-material\"\n                    @click=\"Enviar(material.id)\"\n                  >\n                    ✍🏻\n                  </div>\n                </div>\n                <div class=\"btn-circle-2\">\n                  <div\n                    v-on:click=\"confirmarEliminarSolicitud(material)\"\n                    class=\"btn-circle\"\n                  >\n                    ❌\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"titulo\">{{ material.titulo }}</div>\n          <div class=\"autor\">\n            <img\n              src=\"https://img.icons8.com/ios-filled/18/000000/guest-male--v1.png\"\n            />\n            {{ material.nombre }}\n            <br />\n            {{ material.tipo }}\n            <div style=\"font-size: 100%\">\n              <div class=\"editorial\" style=\"font-size: 100%\"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"estudiante\" v-if=\"acceso == 2\">\n      <div class=\"d-md-block table-responsive table-sm small border\">\n        <table class=\"table text-center table-striped tableMb\" id=\"\">\n          <thead class=\"thMb\">\n            <tr class=\"trMb\">\n              <!-- <th>ID</th> -->\n              <th>TITULO</th>\n              <th>TIPO</th>\n              <th>AUTOR</th>\n              <th>EDITORIAL</th>\n              <th>EDICION</th>\n              <th>CODIGO</th>\n              <th>COPIAS</th>\n              <th>DISPONIBLES</th>\n              <th>ACCION</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr\n              class=\"trMb\"\n              v-for=\"material in datosPaginados\"\n              :key=\"material.id\"\n            >\n              <td data-titulo=\"Titulo: \">{{ material.titulo }}</td>\n              <td data-titulo=\"Tipo: \">{{ material.tipo }}</td>\n              <td data-titulo=\"Autor\">{{ material.nombre }}</td>\n              <td data-titulo=\"Editorial: \">\n                {{ editoriales[[material.idEditorial] - 1].nombreEditorial }}\n              </td>\n              <td data-titulo=\"Edición: \">{{ material.edicion }}</td>\n              <td data-titulo=\"Codigo: \">{{ material.codigo }}</td>\n              <td data-titulo=\"Copias: \">{{ material.copias }}</td>\n              <td data-titulo=\"Disponibles: \">\n                {{ material.copiasDisponibles }}\n              </td>\n              <td data-titulo=\"Accion: \">\n                <div class=\"btn-group\" role=\"group\" aria-label=\"\">\n                  <div v-if=\"material.documento != null\">\n                    <button\n                      @click=\"redireccionaarPdf(material.documento)\"\n                      class=\"btn btn-info\"\n                    >\n                      Ver PDF\n                    </button>\n                  </div>\n                  <div v-else>\n                    <button\n                      v-b-modal.modal-lg\n                      @click=\"\n                        obtenerMaterial(\n                          material.id,\n                          material.titulo,\n                          material.nombre,\n                          editoriales[[material.idEditorial] - 1]\n                            .nombreEditorial,\n                          material.edicion,\n                          material.urlPortada,\n                          material.tipo\n                        )\n                      \"\n                      class=\"btn btn-info\"\n                    >\n                      <font-awesome-icon\n                        icon=\"fa-solid fa-book\"\n                        style=\"color: white\"\n                        class=\"iconos\"\n                      />\n                    </button>\n                  </div>\n\n                  <button\n                    v-b-modal.modal-center\n                    @click=\"Enviar(material.id)\"\n                    class=\"btn btn-success\"\n                  >\n                    <font-awesome-icon icon=\"fa-solid fa-pen-to-square\" />\n                  </button>\n\n                  <button\n                    type=\"button\"\n                    @click=\"confirmarEliminarSolicitud(material)\"\n                    class=\"btn btn-danger\"\n                  >\n                    <font-awesome-icon icon=\"fa-solid fa-trash-can\" />\n                  </button>\n                </div>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n\n    <b-modal\n      id=\"modal-lg\"\n      size=\"lg\"\n      centered\n      title=\"Solicitud de prestamo\"\n      hide-footer\n      hide-close-butto\n      ref=\"modalCenter\"\n    >\n    <template #modal-title>\n    <button  @click=\"closeModal\" class=\"btn btn-sm btn-danger close-button\">X</button>\n    <h5 class=\"modal-title\">Prestamo de material</h5>\n  </template>\n      <modalPrestamo v-bind:material=\"this.prestamoMaterial\">\n       </modalPrestamo>\n    </b-modal>\n\n    <div class=\"estudiante\" v-if=\"acceso == 2\" style=\"display: none\">\n      <div class=\"d-none d-sm-none d-md-block table-responsive table-sm small\">\n        <table class=\"table\" id=\"tablaMateriales\">\n          <thead>\n            <tr>\n              <th>ID</th>\n              <th>TITULO</th>\n              <th>AUTOR</th>\n              <th>EDITORIAL</th>\n              <th>EDICION</th>\n              <th>CODIGO</th>\n              <th>COPIAS</th>\n              <th>DISPONIBLES</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(material, index) in dataToExport\" :key=\"material.id\">\n              <td>{{ index + 1 }}</td>\n              <td>{{ material.titulo }}</td>\n              <td>{{ material.tipo }}</td>\n              <td>{{ material.nombre }}</td>\n              <td>\n                {{ editoriales[[material.idEditorial] - 1].nombreEditorial }}\n              </td>\n              <td>{{ material.edicion }}</td>\n              <td>{{ material.codigo }}</td>\n              <td>{{ material.copias }}</td>\n              <td>{{ material.copiasDisponibles }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// import { Bar } from 'vue-chartjs'\n// import { Chart as ChartJS,Title, ArcElement, Tooltip, Legend,BarElement, CategoryScale, LinearScale } from 'chart.js'\n// import { Doughnut } from 'vue-chartjs'\n// ChartJS.register(Title, ArcElement, Tooltip, Legend, BarElement, CategoryScale, LinearScale)\n// Import component\nimport Loading from \"vue-loading-overlay\";\n// Import stylesheet\nimport \"vue-loading-overlay/dist/vue-loading.css\";\n// import * as XLSX from 'xlsx'\nimport * as saveAs from \"file-saver\";\nimport listar from \"@/views/MaterialesView.vue\";\nimport { jsPDF } from \"jspdf\";\nimport \"jspdf-autotable\";\n// import { Carousel, Slide } from 'vue-carousel';\nimport modalPrestamo from \"@/components/modalPrestamo.vue\";\nimport axios from \"axios\";\n// import CrearLibro from '@/components/CrearLibro.vue'\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\n\nexport default {\n  name: \"ListarMaterial\",\n\n  components: {\n    // Bar,\n    // Doughnut,\n    modalPrestamo,\n    Loading,\n  },\n\n  data() {\n    return {\n      isLoading: true,\n      fullPage: true,\n      dataToExport: [],\n      prestamoMaterial: {\n        id: 0,\n        nombreMaterial: \"\",\n        autor: \"\",\n        editorial: \"\",\n        edicion: \"\",\n        urlPortada: \"\",\n      },\n      tipos: [],\n      subsede: localStorage.getItem(\"idSubsede\"),\n      totalMateriales: [],\n      Materiales: [],\n      autor: [],\n      carreras: [],\n      materia: 1,\n      nombreMaterial: \"\",\n      nombreAutor: 1,\n      editoriales: [],\n      elementosPorPagina: 10,\n      datosPaginados: [],\n      paginaActual: 1,\n      acceso: localStorage.getItem(\"acceso\"),\n\n      radioPdf: 0,\n    };\n  },\n\n  created: async function () {\n    this.consultarAutor();\n    await this.consultarEditorial();\n    this.consultarTipo();\n\n  },\n  async mounted() {\n    await this.consultarCarreras();\n    // this.consultarCantidad();\n    this.ObtenerDatosPag(1);\n   \n  },\n\n  methods: {\n    cambiarRegistrosPorPagina() {\n      this.paginaActual = 1;\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    redireccionaarPdf(pdf) {\n      var a = document.createElement(\"a\");\n      a.target = \"_blank\";\n      a.href = \"http://192.168.0.113:8082/storage/documentos/\" + pdf;\n      a.click();\n    },\n\n    onCancel() {\n      console.log(\"usuario cancelo la carga.\");\n    },\n\n   \n    consultarTipo() {\n      return fetch(RUTA_SERVIDOR_LIBROS + \"/tipos/\")\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          if (typeof datosRespuesta[0].success === \"undefined\") {\n            datosRespuesta.sort((a, b) => {\n              if (a.tipo.toUpperCase() == b.tipo.toUpperCase()) {\n                return 0;\n              }\n              if (a.tipo.toUpperCase() > b.tipo.toUpperCase()) {\n                return 1;\n              }\n              if (a.tipo.toUpperCase() < b.tipo.toUpperCase()) {\n                return -1;\n              }\n            });\n            datosRespuesta.forEach((tipo) => {\n          tipo.stado= \"accepted\"; // Puedes establecer el valor inicial como falso\n        });\n            this.tipos = datosRespuesta;\n          }\n        })\n        .catch(console.log);\n    },\n    consultarMaterlales() {\n      // Llama a consultarTipo() para obtener los tipos antes de consultar los materiales.\n      return this.consultarTipo().then(() => {\n        return fetch(\n          RUTA_SERVIDOR_LIBROS + \"/materialesSubsede/\" + this.subsede\n        )\n          .then((respuesta) => respuesta.json())\n          .then((datosRespuesta) => {\n            this.Materiales = [];\n            if (typeof datosRespuesta[0].success === \"undefined\") {\n              datosRespuesta.sort((a, b) => {\n                if (a.titulo.toUpperCase() == b.titulo.toUpperCase()) {\n                  return 0;\n                }\n                if (a.titulo.toUpperCase() > b.titulo.toUpperCase()) {\n                  return 1;\n                }\n                if (a.titulo.toUpperCase() < b.titulo.toUpperCase()) {\n                  return -1;\n                }\n              });\n              this.Materiales = datosRespuesta;\n\n              this.Materiales.forEach((material) => {\n                const tipoAsociado = this.tipos.find(\n                  (tipo) => tipo.id == material.idTipomaterial\n                );\n                if (tipoAsociado) {\n                  material.tipo = tipoAsociado.tipo;\n                }\n              });\n              console.log(this.Materiales);\n\n              for (let index = 0; index < this.Materiales.length; index++) {\n                for (let index2 = 0; index2 < this.autor.length; index2++) {\n                  if (this.autor[index2].id == this.Materiales[index].idAutor) {\n                    var nombreAutor = this.autor[index2].nombre;\n                    this.Materiales[index].nombre = nombreAutor;\n                  }\n                }\n              }\n\n              this.filtrarMateriales();\n              this.filtrarArchivos();\n            }\n          })\n          .catch(console.log);\n      });\n    },\n    filtrarArchivos() {\n      this.dataToExport = [];\n      for (let index = 0; index < this.Materiales.length; index++) {\n        if (\n          this.Materiales[index].idCarrera === this.materia &&\n          this.Materiales[index].activo === 1 &&\n          this.Materiales[index].documento != null &&\n          this.radioPdf == 1\n        ) {\n          this.dataToExport = this.dataToExport.concat(this.Materiales[index]);\n        } else {\n          if (\n            this.Materiales[index].idCarrera === this.materia &&\n            this.Materiales[index].activo === 1 &&\n            this.Materiales[index].documento == null &&\n            this.radioPdf == 0\n          ) {\n            this.dataToExport = this.dataToExport.concat(\n              this.Materiales[index]\n            );\n          }\n        }\n      }\n      this.isLoading = false;\n    },\n\n    filtrarMateriales() {\n      this.totalMateriales = [];\n      for (let index = 0; index < this.Materiales.length; index++) {\n        if (\n          this.Materiales[index].idCarrera === this.materia &&\n          this.Materiales[index].activo === 1 &&\n          (this.Materiales[index].titulo\n            .toUpperCase()\n            .includes(this.nombreMaterial.toUpperCase()) ||\n            this.Materiales[index].nombre\n              .toUpperCase()\n              .includes(this.nombreMaterial.toUpperCase())) &&\n          this.Materiales[index].documento != null &&\n          this.radioPdf == 1\n        ) {\n         \n          if (this.tipos.some(tipo => tipo.stado == \"accepted\" && tipo.id == this.Materiales[index].idTipomaterial)) {\n        this.totalMateriales = this.totalMateriales.concat(this.Materiales[index]);\n        this.ObtenerDatosPag(1);\n          }\n        \n        } else {\n          if (\n            this.Materiales[index].idCarrera === this.materia &&\n            this.Materiales[index].activo === 1 &&\n            (this.Materiales[index].titulo\n              .toUpperCase()\n              .includes(this.nombreMaterial.toUpperCase()) ||\n              this.Materiales[index].nombre\n                .toUpperCase()\n                .includes(this.nombreMaterial.toUpperCase())) &&\n            this.Materiales[index].documento == null &&\n            this.radioPdf == 0\n          ) {\n            \n            if (this.tipos.some(tipo => tipo.stado == \"accepted\" && tipo.id == this.Materiales[index].idTipomaterial)) {\n        this.totalMateriales = this.totalMateriales.concat(this.Materiales[index]);\n        this.ObtenerDatosPag(1);\n          }\n          \n\n    \n          }\n        }\n      }\n\n      if (this.totalMateriales.length === 0) {\n        this.paginaPrevia();\n        //this.paginaActual=0;\n      }\n    },\n\n    consultarAutor() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/autor/\")\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          this.autor = datosRespuesta;\n\n          this.consultarMaterlales();\n        })\n        .catch(console.log);\n    },\n\n    consultarEditorial() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/editoriales/\")\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          if (typeof datosRespuesta[0].success === \"undefined\") {\n            this.editoriales = datosRespuesta;\n          }\n        })\n        .catch(console.log);\n    },\n\n    Enviar(id) {\n      this.$emit(\"recibiendo\", id);\n      listar.editar();\n    },\n    confirmarEliminarSolicitud(material) {\n      if (\n        window.confirm(\"¿Estás seguro de que deseas eliminar este material?\")\n      ) {\n        this.eliminar(material);\n      }\n    },\n    eliminar(material) {\n      axios\n        .put(RUTA_SERVIDOR_LIBROS + \"/materiales/\" + material.id, {\n          titulo: material.titulo,\n          copias: material.copias,\n          copiasDisponibles: material.copiasDisponibles,\n          idTipomaterial: material.idTipomaterial,\n          edicion: material.edicion,\n          codigo: material.codigo,\n          idAutor: parseInt(material.idAutor),\n          idEmpleado: material.idEmpleado,\n          idEditorial: parseInt(material.idEditorial),\n          idCarrera: parseInt(material.idCarrera),\n          urlPortada: material.urlPortada,\n          observacion: material.observacion,\n          documento: material.documento,\n          activo: 0,\n        })\n        .then(function (response) {\n          location.reload();\n        })\n        .catch(function (error) {\n          console.log(error);\n          // console.log(this.material);\n        });\n    },\n    obtenerMaterial(id, nombre, autor, editorial, edicion, urlPortada, tipo) {\n      this.prestamoMaterial = {\n        id: id,\n\n        nombreMaterial: nombre,\n        autor: autor,\n        editorial: editorial,\n        edicion: edicion,\n        urlPortada: urlPortada,\n        tipo: tipo,\n      };\n    },\n\n    consultarCarreras() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/carreras\")\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          this.carreras = [];\n          if (typeof datosRespuesta[0].success === \"undefined\") {\n            this.carreras = datosRespuesta;\n          }\n          \n        })\n        .catch(console.log);\n    },\n\n    consultarCantidad() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/cantidadMateriales/\" + this.subsede)\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          if (typeof datosRespuesta[0].success === \"undefined\") {\n            for (let index = 0; index < datosRespuesta[1].length; index++) {\n              this.chartDataL.labels.push(\n                datosRespuesta[1][index][0] +\n                  \" : \" +\n                  datosRespuesta[1][index][1]\n              );\n              this.chartDataL.datasets[0].data.push(\n                datosRespuesta[1][index][1]\n              );\n\n              this.totalesL += datosRespuesta[1][index][1];\n              this.totalesD += datosRespuesta[2][index][1];\n              this.dataBar.labels.push(datosRespuesta[1][index][0]);\n\n              this.dataBar.datasets[0].data.push(datosRespuesta[1][index][1]);\n              this.dataBar.datasets[1].data.push(datosRespuesta[2][index][1]);\n            }\n            // this.data.labels.push(datosRespuesta[1][index][0]+ ' : '+datosRespuesta[1][index][1] )\n            for (let index = 0; index < datosRespuesta[0].length; index++) {\n              this.chartDataP.labels.push(\n                datosRespuesta[0][index][0] +\n                  \" : \" +\n                  datosRespuesta[0][index][1]\n              );\n              this.chartDataP.datasets[0].data.push(\n                datosRespuesta[0][index][1]\n              );\n            }\n          }\n          this.dataBar.datasets[0].label.push(\n            \"Materiales Totales : \" + this.totalesL\n          );\n          this.dataBar.datasets[1].label.push(\n            \"Materiales Disponibles : \" + this.totalesD\n          );\n        })\n        .catch(console.log);\n    },\n\n    totalPaginas() {\n      if (this.elementosPorPagina === -1) {\n        return 1; // Mostrar todo en una sola página\n      }\n      return Math.ceil(this.totalMateriales.length / this.elementosPorPagina);\n    },\n    ObtenerDatosPag(noPag) {\n      this.paginaActual = noPag;\n      this.datosPaginados = [];\n\n      let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n      let fin = noPag * this.elementosPorPagina;\n      this.datosPaginados = this.totalMateriales.slice(ini, fin);\n    },\n\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n    precionadoBoton(id) {\n      console.log(id);\n    },\n    cambiaC(carrera) {\n      this.materia = carrera;\n      this.filtrarMateriales();\n      this.filtrarArchivos();\n    },\n\n    exportExcel() {\n      const tabla = document.createElement(\"table\");\n      const thead = tabla.createTHead();\n      const tbody = tabla.createTBody();\n\n      // Agregar encabezados de columna a la tabla\n      const encabezados = [\n        \"Id\",\n        \"Tipo\",\n        \"Titulo\",\n        \"Autor\",\n        \"Editorial\",\n        \"Edicion\",\n        \"Codigo\",\n        \"Copias\",\n        \"Disponibles\",\n      ];\n      const encabezadosRow = thead.insertRow();\n      encabezados.forEach((encabezado) => {\n        const th = document.createElement(\"th\");\n        th.innerText = encabezado;\n        encabezadosRow.appendChild(th);\n      });\n\n      // Agregar filas de datos a la tabla\n      this.datosPaginados.forEach((material) => {\n        const fila = tbody.insertRow();\n        fila.insertCell().innerText = material.id;\n        fila.insertCell().innerText = material.tipo;\n        \n        fila.insertCell().innerText = material.titulo;\n        fila.insertCell().innerText = material.nombre;\n        (fila.insertCell().innerText =\n          this.editoriales[[material.idEditorial] - 1].nombreEditorial),\n          (fila.insertCell().innerText = material.edicion);\n        fila.insertCell().innerText = material.codigo;\n        fila.insertCell().innerText = material.copias;\n        fila.insertCell().innerText = material.copiasDisponibles;\n      });\n\n      // Crear un archivo Blob para la tabla HTML\n      const blob = new Blob([tabla.outerHTML], {\n        type: \"application/vnd.ms-excel\",\n      });\n\n      const link = document.createElement(\"a\");\n      link.href = URL.createObjectURL(blob);\n      link.download = \"Materiales.xls\";\n\n      link.click();\n    },\n\n    exportPdf() {\n      var doc = new jsPDF();\n      //titulo\n      doc.setFontSize(16);\n      var title = \"Materiales\";\n      var titleWidth =\n        (doc.getStringUnitWidth(title) * doc.internal.getFontSize()) /\n        doc.internal.scaleFactor;\n      var pageWidth = doc.internal.pageSize.getWidth();\n      var x = (pageWidth - titleWidth) / 2;\n      doc.text(title, x, 10);\n      // Obtener la tabla visible\n      var table = document.querySelector(\".tableMb\");\n\n      // Obtener la tabla visible\n      var table = document.querySelector(\".tableMb\");\n\n      // Configurar los estilos de la tabla\n      var styles = {\n        overflow: \"linebreak\",\n        fontSize: 8, // Tamaño de fuente reducido\n        lineWidth: 0.1,\n        lineColor: [0, 0, 0], // Color de las líneas\n        font: \"helvetica\",\n        fontStyle: \"normal\",\n        halign: \"center\", // Alineación horizontal\n        valign: \"middle\", // Alineación vertical\n        cellPadding: 2,\n        tableWidth: \"auto\",\n        tableBorder: 1,\n        tableLineColor: [0, 0, 0], // Color del borde de la tabla\n        tableFillColor: [255, 255, 255], // Color de fondo de la tabla\n        textColor: 0,\n        cellWidth: \"auto\", // Ajustar el ancho de la celda automáticamente\n      };\n\n      // Ocultar la última columna (Acción) antes de agregar la tabla al documento PDF\n      var actionColumn = table.querySelector(\"th:last-child, td:last-child\");\n      if (actionColumn) {\n        actionColumn.style.display = \"none\";\n      }\n\n      // Agregar la tabla al documento PDF\n      doc.autoTable({ html: table, startY: 20, styles });\n\n      // Mostrar la última columna nuevamente\n      if (actionColumn) {\n        actionColumn.style.display = \"table-cell\";\n      }\n\n      // Guardar el PDF\n      doc.save(\"Materiales.pdf\");\n    },\n    closeModal() {\n      this.$refs.modalCenter.hide();\n    },\n  },\n};\n</script>\n\n<style>\n\n.todoFondo{\n  position: relative;\n}\n.loading-spinner {\n  position:absolute;\n  \n\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgb(255, 255, 255); /* Fondo semi-transparente */\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 9999;\n}\n\n.spinner {\n  border: 4px solid rgba(0, 0, 0, 0.1);\n  border-left: 4px solid #000000;\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  animation: spin 3s linear infinite;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 5s; /* La duración de la transición */\n}\n\n.fade-enter,\n.fade-leave-to {\n  opacity: 0;\n}\n.my-chart-id {\n  width: 30px;\n  height: 30px;\n}\n\n.groupB {\n  width: 8rem;\n}\n\n.btn-circle-2,\n.btn-material-1,\n.btn-material-2 {\n  position: absolute;\n  bottom: 0.5rem;\n  left: 0.5rem;\n  width: 2.5rem;\n  height: 2.5rem;\n\n  text-align: center;\n  line-height: 1.8rem;\n  cursor: pointer;\n  /* background: #e1e1e1;\n\n  box-shadow:  5px 5px 10px #a9a9a9,\n             -5px -5px 10px #dddddd; */\n}\n\n.btn-circle,\n.btn-material {\n  position: absolute;\n\n  width: 2rem;\n  height: 2rem;\n  border-radius: 50%;\n\n  background-color: rgb(237, 237, 237);\n  border: rgb(118, 118, 118) 0.07rem solid;\n\n  text-align: center;\n  line-height: 1.8rem;\n  cursor: pointer;\n\n  transition: all 0.2s ease-in-out;\n}\n\n.btn-material-1 {\n  left: 8rem;\n}\n.btn-material-2 {\n  left: 4.25rem;\n}\n.btn-circle:active,\n.btn-material:active {\n  box-shadow: inset 4px 4px 8px #a9a9a9, inset -4px -4px 8px #ffffff;\n  font-size: 1.4em;\n}\n\n.titulo {\n  width: 10rem;\n  font-size: 12px;\n  font-weight: bold;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.editorial {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n.autor {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 0rem;\n  padding-bottom: 0.5rem;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  overflow: hidden;\n  width: 10rem;\n  font-size: 12px;\n\n  margin-bottom: 2rem;\n}\n\n.icon-container-2 {\n  position: relative;\n  width: 10rem;\n  height: 16rem;\n  padding: 0;\n\n  padding-top: 0.5rem;\n}\n\n.icon-container-2 {\n  transition: all 0.3s ease;\n  color: #41403e;\n  font-size: 2rem;\n  letter-spacing: 1px;\n  outline: none;\n  box-shadow: 20px 38px 34px -26px hsla(0, 0%, 0%, 0.2);\n  border-color: #a9a9a9;\n  border: solid;\n}\n.icon-container-2:hover {\n  box-shadow: 2px 8px 4px -6px rgba(0, 0, 0, 0.501);\n  -webkit-transform: scale(0.98);\n  -ms-transform: scale(0.98);\n  transform: scale(0.98);\n}\n.icon-container-2.lined.thin {\n  border: solid 2px #282828;\n}\n\n@media screen and (max-width: 480px) {\n  .titulo {\n    margin-top: 0;\n    padding-top: 0.5rem;\n\n    font-size: 12px;\n  }\n  .autor {\n    overflow: hidden;\n\n    font-size: 12px;\n  }\n\n  .icon-container-2 {\n    width: 9.5rem;\n    height: 16rem;\n    padding: 0;\n\n    padding-top: 0.5rem;\n  }\n\n  .btn-circle,\n  .btn-material {\n    position: absolute;\n\n    width: 2rem;\n    height: 2rem;\n\n    background-color: rgb(255, 255, 255);\n\n    text-align: center;\n    line-height: 1.8rem;\n    cursor: pointer;\n\n    transition: all 0.2s ease-in-out;\n  }\n\n  .btn-material-1 {\n    left: 6.5rem;\n  }\n  .btn-material-2 {\n    left: 3.5rem;\n  }\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}