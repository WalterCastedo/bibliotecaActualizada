{"ast":null,"code":"import { defineComponent, ref, computed, onMounted, onBeforeUnmount, resolveComponent, openBlock, createElementBlock, normalizeStyle, withKeys, withModifiers, renderSlot, createVNode, createCommentVNode } from \"vue\";\nimport { i as isServer } from \"../../utils/ssr.js\";\nimport { w as warn } from \"../../utils/console.js\";\nimport { u as useComponentPresetProp } from \"../../composables/useComponentPreset.js\";\nimport { u as useTranslation } from \"../../composables/useTranslation.js\";\nimport { V as VaButton } from \"../va-button/index.js\";\nimport { _ as _export_sfc } from \"../../../plugin-vue_export-helper.js\";\n\nvar VaBacktop_vue_vue_type_style_index_0_lang = /* @__PURE__ */(() => \":root{--va-backtop-position: fixed;--va-backtop-top: auto;--va-backtop-left: auto;--va-backtop-right: auto;--va-backtop-bottom: auto;--va-backtop-cursor: pointer;--va-backtop-z-index: 3}.va-backtop{position:var(--va-backtop-position);top:var(--va-backtop-top);left:var(--va-backtop-left);right:var(--va-backtop-right);bottom:var(--va-backtop-bottom);cursor:var(--va-backtop-cursor);z-index:var(--va-backtop-z-index);font-family:var(--va-font-family)}\\n\")();\n\nconst _sfc_main = defineComponent({\n  name: \"VaBacktop\",\n  components: {\n    VaButton\n  },\n  props: { ...useComponentPresetProp,\n    target: {\n      type: [Object, String],\n      default: void 0\n    },\n    visibilityHeight: {\n      type: Number,\n      default: 300\n    },\n    speed: {\n      type: Number,\n      default: 50\n    },\n    verticalOffset: {\n      type: String,\n      default: \"1rem\"\n    },\n    horizontalOffset: {\n      type: String,\n      default: \"1rem\"\n    },\n    color: {\n      type: String,\n      default: \"\"\n    },\n    horizontalPosition: {\n      type: String,\n      default: \"right\",\n      validator: value => [\"right\", \"left\"].includes(value)\n    },\n    verticalPosition: {\n      type: String,\n      default: \"bottom\",\n      validator: value => [\"bottom\", \"top\"].includes(value)\n    }\n  },\n\n  setup(props) {\n    const targetScrollValue = ref(0);\n    const computedStyle = computed(() => ({\n      [props.verticalPosition]: props.verticalOffset,\n      [props.horizontalPosition]: props.horizontalOffset\n    }));\n    let targetElement;\n\n    const getTargetElement = () => {\n      if (!props.target) {\n        return window;\n      }\n\n      if (typeof props.target === \"string\") {\n        const target = document.querySelector(props.target);\n\n        if (!target) {\n          warn(`Target element [${props.target}] is not found, falling back to window.`);\n          return window;\n        }\n\n        return target;\n      }\n\n      return props.target;\n    };\n\n    const scrolled = ref(false);\n    const interval = ref(0);\n\n    const scrollToTop = () => {\n      if (scrolled.value) {\n        return;\n      }\n\n      scrolled.value = true;\n\n      if (targetElement instanceof Window) {\n        window.scrollTo({\n          top: 0,\n          behavior: \"smooth\"\n        });\n        return;\n      }\n\n      interval.value = window.setInterval(() => {\n        if (targetElement instanceof Element) {\n          if (targetElement.scrollTop === 0) {\n            clearInterval(interval.value);\n            scrolled.value = false;\n          } else {\n            const next = Math.floor(targetElement.scrollTop - props.speed);\n            targetElement.scrollTo(0, next);\n          }\n        }\n      }, 15);\n    };\n\n    const handleScroll = () => {\n      targetScrollValue.value = targetElement instanceof Window ? targetElement.scrollY : targetElement.scrollTop;\n    };\n\n    const server = isServer();\n    const visible = computed(() => {\n      if (server) {\n        return false;\n      }\n\n      return targetScrollValue.value > props.visibilityHeight;\n    });\n\n    if (!server) {\n      onMounted(() => {\n        targetElement = getTargetElement();\n        targetElement.addEventListener(\"scroll\", handleScroll, true);\n      });\n      onBeforeUnmount(() => targetElement == null ? void 0 : targetElement.removeEventListener(\"scroll\", handleScroll));\n    }\n\n    return {\n      computedStyle,\n      visible,\n      scrollToTop,\n      ...useTranslation()\n    };\n  }\n\n});\n\nconst _hoisted_1 = [\"aria-label\"];\n\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_va_button = resolveComponent(\"va-button\");\n\n  return _ctx.visible ? (openBlock(), createElementBlock(\"div\", {\n    key: 0,\n    class: \"va-backtop\",\n    role: \"button\",\n    \"aria-label\": _ctx.t(\"backToTop\"),\n    style: normalizeStyle(_ctx.computedStyle),\n    onClick: _cache[0] || (_cache[0] = (...args) => _ctx.scrollToTop && _ctx.scrollToTop(...args)),\n    onKeydown: _cache[1] || (_cache[1] = withKeys(withModifiers((...args) => _ctx.scrollToTop && _ctx.scrollToTop(...args), [\"stop\"]), [\"enter\"]))\n  }, [renderSlot(_ctx.$slots, \"default\", {}, () => [createVNode(_component_va_button, {\n    \"aria-hidden\": \"true\",\n    icon: \"va-arrow-up\",\n    color: _ctx.color\n  }, null, 8, [\"color\"])])], 44, _hoisted_1)) : createCommentVNode(\"\", true);\n}\n\nvar _VaBacktop = /* @__PURE__ */_export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\n\nexport { _VaBacktop as _ };\nimport './VaBacktop.css';","map":{"version":3,"mappings":"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","names":["_sfc_main","defineComponent","name","components","VaButton","props","useComponentPresetProp","target","type","Object","String","default","visibilityHeight","Number","speed","verticalOffset","horizontalOffset","color","horizontalPosition","validator","value","includes","verticalPosition","setup","ref","computed","getTargetElement","document","querySelector","warn","scrollToTop","scrolled","targetElement","Window","window","scrollTo","top","behavior","interval","setInterval","Element","scrollTop","clearInterval","next","Math","floor","handleScroll","targetScrollValue","scrollY","server","isServer","onMounted","onBeforeUnmount","removeEventListener","computedStyle","visible","useTranslation","_createElementBlock","key","class","role","_ctx","t","style","_normalizeStyle","onClick","_cache","onKeydown","_renderSlot","_createVNode","_component_va_button","icon"],"sources":["../../../../../src/components/va-backtop/VaBacktop.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"visible\"\n    class=\"va-backtop\"\n    role=\"button\"\n    :aria-label=\"t('backToTop')\"\n    :style=\"computedStyle\"\n    @click=\"scrollToTop\"\n    @keydown.enter.stop=\"scrollToTop\"\n  >\n    <slot>\n      <va-button\n        aria-hidden=\"true\"\n        icon=\"va-arrow-up\"\n        :color=\"color\"\n      />\n    </slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType, ref, computed, onMounted, onBeforeUnmount } from 'vue'\nimport { useComponentPresetProp, useTranslation } from '../../composables'\nimport { VaButton } from '../va-button'\nimport { isServer } from '../../utils/ssr'\nimport { warn } from '../../utils/console'\n\nexport default defineComponent({\n  name: 'VaBacktop',\n  components: { VaButton },\n  props: {\n    ...useComponentPresetProp,\n    target: {\n      type: [Object, String] as PropType<Element | string | undefined>,\n      default: undefined,\n    },\n    visibilityHeight: { type: Number, default: 300 },\n    speed: { type: Number, default: 50 },\n    verticalOffset: { type: String, default: '1rem' },\n    horizontalOffset: { type: String, default: '1rem' },\n    color: { type: String, default: '' },\n    horizontalPosition: {\n      type: String as PropType<'right' | 'left'>,\n      default: 'right',\n      validator: (value: string) => ['right', 'left'].includes(value),\n    },\n    verticalPosition: {\n      type: String as PropType<'bottom' | 'top'>,\n      default: 'bottom',\n      validator: (value: string) => ['bottom', 'top'].includes(value),\n    },\n  },\n  setup (props) {\n    const targetScrollValue = ref(0)\n\n    const computedStyle = computed(() => ({\n      [props.verticalPosition]: props.verticalOffset,\n      [props.horizontalPosition]: props.horizontalOffset,\n    }))\n\n    let targetElement: Element | Window\n\n    const getTargetElement = (): Element | Window => {\n      if (!props.target) {\n        return window\n      }\n      if (typeof props.target === 'string') {\n        const target = document.querySelector(props.target) as Element\n        if (!target) {\n          warn(`Target element [${props.target}] is not found, falling back to window.`)\n          return window\n        }\n        return target\n      }\n      return props.target as Element\n    }\n\n    const scrolled = ref(false)\n    const interval = ref(0)\n    const scrollToTop = () => {\n      if (scrolled.value) { return }\n\n      scrolled.value = true\n\n      if (targetElement instanceof Window) {\n        window.scrollTo({\n          top: 0,\n          behavior: 'smooth',\n        })\n\n        return\n      }\n\n      interval.value = window.setInterval(() => {\n        if (targetElement instanceof Element) {\n          if (targetElement.scrollTop === 0) {\n            clearInterval(interval.value)\n            scrolled.value = false\n          } else {\n            const next = Math.floor(targetElement.scrollTop - props.speed)\n            targetElement.scrollTo(0, next)\n          }\n        }\n      }, 15)\n    }\n\n    const handleScroll = () => {\n      targetScrollValue.value = targetElement instanceof Window\n        ? targetElement.scrollY\n        : targetElement.scrollTop\n    }\n\n    const server = isServer()\n\n    const visible = computed(() => {\n      if (server) {\n        return false\n      }\n      return targetScrollValue.value > props.visibilityHeight\n    })\n\n    if (!server) {\n      onMounted(() => {\n        targetElement = getTargetElement()\n        targetElement.addEventListener('scroll', handleScroll, true)\n      })\n      onBeforeUnmount(() => targetElement?.removeEventListener('scroll', handleScroll))\n    }\n\n    return {\n      computedStyle,\n      visible,\n      scrollToTop,\n      ...useTranslation(),\n    }\n  },\n})\n</script>\n\n<style lang=\"scss\">\n@import \"variables\";\n\n.va-backtop {\n  position: var(--va-backtop-position);\n  top: var(--va-backtop-top);\n  left: var(--va-backtop-left);\n  right: var(--va-backtop-right);\n  bottom: var(--va-backtop-bottom);\n  cursor: var(--va-backtop-cursor);\n  z-index: var(--va-backtop-z-index);\n  font-family: var(--va-font-family);\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}