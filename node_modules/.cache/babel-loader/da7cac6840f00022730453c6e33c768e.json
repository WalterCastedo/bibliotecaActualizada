{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n//import Vue from 'vue'\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\nexport default {\n  name: \"loginComponent\",\n\n  data() {\n    return {\n      showPassword: false,\n      usuario: {\n        cod_alum: \"\",\n        ci_pasaporte: \"\",\n        carrera: \"\",\n        facultad: \"\",\n        subsede: \"\"\n      }\n    };\n  },\n\n  methods: {\n    async login() {\n      try {\n        const alumnoResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/alumno/${this.usuario.cod_alum}/${this.usuario.ci_pasaporte}`);\n        const datosRespuesta = await alumnoResponse.json();\n\n        if (datosRespuesta) {\n          // Almacenar datos del usuario en el almacenamiento local\n          localStorage.setItem(\"acceso\", 1);\n          localStorage.setItem(\"cod_alum\", datosRespuesta.cod_alum);\n          localStorage.setItem(\"ci_pasaporte\", datosRespuesta.ci_pasaporte);\n          localStorage.setItem(\"nombre\", datosRespuesta.nombre);\n          localStorage.setItem(\"ap_paterno\", datosRespuesta.ap_paterno);\n          localStorage.setItem(\"ap_materno\", datosRespuesta.ap_materno);\n          localStorage.setItem(\"sede\", datosRespuesta.sede);\n          this.usuario.carrera = datosRespuesta.id_carrera;\n          const carreraResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/carrera/${this.usuario.carrera}`);\n          const carreraData = await carreraResponse.json();\n\n          if (Array.isArray(carreraData) && carreraData.length > 0) {\n            this.usuario.facultad = carreraData[0].id_facultad;\n          } else {\n            console.error(\"No se encontraron datos de carrera\");\n          }\n\n          const facultadResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/facultad/${this.usuario.facultad}`);\n          const facultadData = await facultadResponse.json();\n          this.usuario.subsede = facultadData[0].id_subsede;\n          const subsedeResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/subsede/${this.usuario.subsede}`);\n          const subsedeData = await subsedeResponse.json(); // Almacenar datos adicionales del usuario en el almacenamiento local\n\n          localStorage.setItem(\"idCarrera\", this.usuario.carrera);\n          localStorage.setItem(\"idFacultad\", this.usuario.facultad);\n          localStorage.setItem(\"idSubsede\", subsedeData[0].id);\n          localStorage.setItem(\"Subsede\", subsedeData[0].subsede); // Actualizar la página y navegar a la ruta \"libros\"\n\n          location.reload();\n          this.$router.push({\n            name: \"libros\"\n          });\n        }\n      } catch (error) {\n        // Manejar errores aquí\n        console.error(\"Ocurrió un error:\", error);\n      } // Llamada adicional para el acceso \"empleado\"\n\n\n      try {\n        const empleadoResponse = await fetch(`${RUTA_SERVIDOR_LIBROS}/empleado/${this.usuario.cod_alum}/${this.usuario.ci_pasaporte}`);\n        const datosRespuestaEmpleado = await empleadoResponse.json();\n\n        if (datosRespuestaEmpleado) {\n          // Almacenar datos del empleado en el almacenamiento local\n          localStorage.setItem(\"acceso\", 2);\n          localStorage.setItem(\"cod_alum\", datosRespuestaEmpleado.cod_alum);\n          localStorage.setItem(\"ci_pasaporte\", datosRespuestaEmpleado.ci_pasaporte);\n          localStorage.setItem(\"nombre\", datosRespuestaEmpleado.nombre);\n          localStorage.setItem(\"ap_paterno\", datosRespuestaEmpleado.ap_paterno);\n          localStorage.setItem(\"ap_materno\", datosRespuestaEmpleado.ap_materno);\n          localStorage.setItem(\"sede\", datosRespuestaEmpleado.sede);\n          localStorage.setItem(\"idSubsede\", datosRespuestaEmpleado.idSubsede);\n          localStorage.setItem(\"id\", datosRespuestaEmpleado.id);\n          const subsedeResponseEmpleado = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/subsede/${localStorage.getItem(\"idSubsede\")}`);\n          const subsedeDataEmpleado = await subsedeResponseEmpleado.json(); // Almacenar datos adicionales del empleado en el almacenamiento local\n\n          localStorage.setItem(\"Subsede\", subsedeDataEmpleado[0].subsede); // Actualizar la página y navegar a la ruta \"libros\"\n\n          location.reload();\n          this.$router.push({\n            name: \"libros\"\n          });\n        } else {\n          // Muestra el modal de error de inicio de sesión\n          this.showErrorModal();\n        }\n      } catch (error) {\n        // Manejar errores aquí\n        this.showErrorModal();\n        console.error(\"Ocurrió un error:\", error);\n      }\n    },\n\n    showErrorModal() {\n      const errorModal = document.getElementById(\"loginErrorModal\");\n\n      if (errorModal) {\n        errorModal.classList.add(\"show\");\n        errorModal.style.display = \"block\";\n        errorModal.setAttribute(\"aria-hidden\", \"false\");\n      }\n    },\n\n    closeErrorModal() {\n      const errorModal = document.getElementById(\"loginErrorModal\");\n\n      if (errorModal) {\n        errorModal.classList.remove(\"show\");\n        errorModal.style.display = \"none\";\n        errorModal.setAttribute(\"aria-hidden\", \"true\");\n      }\n    },\n\n    togglePasswordVisibility() {\n      this.showPassword = !this.showPassword;\n      const input = document.querySelector('.input_pass');\n\n      if (input) {\n        if (this.showPassword) {\n          // Si showPassword es verdadero, cambiamos el tipo de entrada a \"text\" para mostrar la contraseña.\n          input.type = 'text';\n        } else {\n          // Si showPassword es falso, volvemos a cambiar el tipo de entrada a \"password\" para ocultar la contraseña.\n          input.type = 'password';\n        }\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";AA+GA;AACA;AACA;AAEA;EACAA,sBADA;;EAEAC;IACA;MACAC,mBADA;MAEAC;QACAC,YADA;QAEAC,gBAFA;QAGAC,WAHA;QAIAC,YAJA;QAKAC;MALA;IAFA;EAUA,CAbA;;EAeAC;IACA;MACA;QACA;QACA;;QAEA;UACA;UACAC;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACA;UAEA;UACA;;UAEA;YACA;UACA,CAFA,MAEA;YACAC;UACA;;UAEA;UACA;UACA;UAEA;UACA,iDAzBA,CA2BA;;UACAD;UACAA;UACAA;UACAA,wDA/BA,CAiCA;;UACAE;UACA;YAAAZ;UAAA;QACA;MACA,CAzCA,CAyCA;QACA;QACAW;MACA,CA7CA,CA+CA;;;MACA;QACA;QACA;;QAEA;UACA;UACAD;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UAEA;UACA,iEAbA,CAeA;;UACAA,gEAhBA,CAkBA;;UACAE;UACA;YAAAZ;UAAA;QACA,CArBA,MAsBA;UACA;UACA;QACA;MACA,CA9BA,CA8BA;QACA;QACA;QACAW;MACA;IACA,CApFA;;IAqFAE;MACA;;MACA;QACAC;QACAA;QACAA;MACA;IACA,CA5FA;;IA6FAC;MACA;;MACA;QACAD;QACAA;QACAA;MACA;IACA,CApGA;;IAqGAE;MACA;MACA;;MAEA;QACA;UACA;UACAC;QACA,CAHA,MAGA;UACA;UACAA;QACA;MACA;IACA;;EAlHA;AAfA","names":["name","data","showPassword","usuario","cod_alum","ci_pasaporte","carrera","facultad","subsede","methods","localStorage","console","location","showErrorModal","errorModal","closeErrorModal","togglePasswordVisibility","input"],"sourceRoot":"src/components","sources":["loginComponent.vue"],"sourcesContent":["<template>\n  <div>\n    \n      <div class=\"todo mt-5\">\n        <div class=\"user_card mt-5\">\n          <div class=\"d-flex justify-content-center\">\n            <div class=\"brand_logo_container\">\n              <img\n                src=\"../img/image.webp\"\n                class=\"brand_logo\"\n                alt=\"Logo\"\n              />\n            </div>\n          </div>\n          <div class=\"d-flex justify-content-center form_container\">\n            <form v-on:submit.prevent=\"login\" class=\"col-sm-9\">\n              <div class=\"input-group mb-3\">\n                <div class=\"input-group-append\">\n                  <span class=\"input-group-text\"\n                    ><svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"16\"\n                      height=\"16\"\n                      fill=\"currentColor\"\n                      class=\"bi bi-person-circle\"\n                      viewBox=\"0 0 16 16\"\n                    >\n                      <path d=\"M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z\" />\n                      <path\n                        fill-rule=\"evenodd\"\n                        d=\"M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z\"\n                      /></svg>\n                      </span>\n                </div>\n                <input\n                  v-model=\"usuario.cod_alum\"\n                  type=\"text\"\n                  name=\"cod_alum\"\n                  class=\"form-control input_user\"\n                  value=\"\"\n                  placeholder=\"Codigo de Alumno\"\n                />\n              </div>\n              <div class=\"input-group grupoInicio mb-2\">\n                <div class=\"input-group-append\">\n                  <span class=\"input-group-text\"\n                    ><svg\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                      width=\"16\"\n                      height=\"16\"\n                      fill=\"currentColor\"\n                      class=\"bi bi-key-fill\"\n                      viewBox=\"0 0 16 16\"\n                    >\n                      <path\n                        d=\"M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"/></svg></span>\n                </div>\n                <input\n                  v-model=\"usuario.ci_pasaporte\"\n                  type=\"password\"\n                  name=\"ca\"\n                  class=\"form-control input_pass\"\n                  value=\"\"\n                  placeholder=\"Ci/Password\"\n                />\n                <div class=\"input-group-append\">\n    <button @click=\"togglePasswordVisibility\" class=\"ojo\" type=\"button\">\n      <div v-if=\"showPassword\" class=\"bi bi-eye-slash\" >\n      👁️ \n      </div>\n      <div v-else  class=\"bi bi-eye\" viewBox=\"0 0 16 16\">\n      ➖  \n      </div>\n    </button>\n  </div>\n              </div>\n\n              <div class=\"d-flex justify-content-center mt-3 login_container\">\n                <button text=\"Iniciar sesión\" id=\"login\" type=\"submit\" name=\"button\" class=\"btn login_btn mt-4\">\n                  Iniciar sesión\n                </button>\n              </div>\n            </form>\n          </div>\n\n          <div class=\"mt-4\"></div>\n        </div>\n      </div>\n    <!-- Modal para mostrar mensaje de error -->\n    <div class=\"modal fade\" id=\"loginErrorModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"loginErrorModalLabel\" aria-hidden=\"true\">\n      <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <h5 class=\"modal-title\" id=\"loginErrorModalLabel\">Error de inicio de sesión</h5>\n            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" @click=\"closeErrorModal\">\n              <span aria-hidden=\"true\">&times;</span>\n            </button>\n          </div>\n          <div class=\"modal-body\">\n            El inicio de sesión ha fallado. Verifica tus credenciales e inténtalo nuevamente.\n          </div>\n          <div class=\"modal-footer\">\n            <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\" @click=\"closeErrorModal\">Cerrar</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n//import Vue from 'vue'\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\n\nexport default {\n  name: \"loginComponent\",\n  data() {\n    return {\n      showPassword: false,\n      usuario: {\n        cod_alum: \"\",\n        ci_pasaporte: \"\",\n        carrera: \"\",\n        facultad: \"\",\n        subsede: \"\",\n      },\n    };\n  },\n\n  methods: {\n    async login() {\n  try {\n    const alumnoResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/alumno/${this.usuario.cod_alum}/${this.usuario.ci_pasaporte}`);\n    const datosRespuesta = await alumnoResponse.json();\n\n    if (datosRespuesta) {\n      // Almacenar datos del usuario en el almacenamiento local\n      localStorage.setItem(\"acceso\", 1);\n      localStorage.setItem(\"cod_alum\", datosRespuesta.cod_alum);\n      localStorage.setItem(\"ci_pasaporte\", datosRespuesta.ci_pasaporte);\n      localStorage.setItem(\"nombre\", datosRespuesta.nombre);\n      localStorage.setItem(\"ap_paterno\", datosRespuesta.ap_paterno);\n      localStorage.setItem(\"ap_materno\", datosRespuesta.ap_materno);\n      localStorage.setItem(\"sede\", datosRespuesta.sede);\n      this.usuario.carrera = datosRespuesta.id_carrera;\n\n      const carreraResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/carrera/${this.usuario.carrera}`);\n      const carreraData = await carreraResponse.json();\n\n      if (Array.isArray(carreraData) && carreraData.length > 0) {\n        this.usuario.facultad = carreraData[0].id_facultad;\n      } else {\n        console.error(\"No se encontraron datos de carrera\");\n      }\n\n      const facultadResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/facultad/${this.usuario.facultad}`);\n      const facultadData = await facultadResponse.json();\n      this.usuario.subsede = facultadData[0].id_subsede;\n\n      const subsedeResponse = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/subsede/${this.usuario.subsede}`);\n      const subsedeData = await subsedeResponse.json();\n\n      // Almacenar datos adicionales del usuario en el almacenamiento local\n      localStorage.setItem(\"idCarrera\", this.usuario.carrera);\n      localStorage.setItem(\"idFacultad\", this.usuario.facultad);\n      localStorage.setItem(\"idSubsede\", subsedeData[0].id);\n      localStorage.setItem(\"Subsede\", subsedeData[0].subsede);\n\n      // Actualizar la página y navegar a la ruta \"libros\"\n      location.reload();\n      this.$router.push({ name: \"libros\" });\n    }\n  } catch (error) {\n    // Manejar errores aquí\n    console.error(\"Ocurrió un error:\", error);\n  }\n\n  // Llamada adicional para el acceso \"empleado\"\n  try {\n    const empleadoResponse = await fetch(`${RUTA_SERVIDOR_LIBROS}/empleado/${this.usuario.cod_alum}/${this.usuario.ci_pasaporte}`);\n    const datosRespuestaEmpleado = await empleadoResponse.json();\n\n    if (datosRespuestaEmpleado) {\n      // Almacenar datos del empleado en el almacenamiento local\n      localStorage.setItem(\"acceso\", 2);\n      localStorage.setItem(\"cod_alum\", datosRespuestaEmpleado.cod_alum);\n      localStorage.setItem(\"ci_pasaporte\", datosRespuestaEmpleado.ci_pasaporte);\n      localStorage.setItem(\"nombre\", datosRespuestaEmpleado.nombre);\n      localStorage.setItem(\"ap_paterno\", datosRespuestaEmpleado.ap_paterno);\n      localStorage.setItem(\"ap_materno\", datosRespuestaEmpleado.ap_materno);\n      localStorage.setItem(\"sede\", datosRespuestaEmpleado.sede);\n      localStorage.setItem(\"idSubsede\", datosRespuestaEmpleado.idSubsede);\n      localStorage.setItem(\"id\", datosRespuestaEmpleado.id);\n      \n      const subsedeResponseEmpleado = await fetch(`${RUTA_SERVIDOR_ALUMNOS}/subsede/${localStorage.getItem(\"idSubsede\")}`);\n      const subsedeDataEmpleado = await subsedeResponseEmpleado.json();\n\n      // Almacenar datos adicionales del empleado en el almacenamiento local\n      localStorage.setItem(\"Subsede\", subsedeDataEmpleado[0].subsede);\n\n      // Actualizar la página y navegar a la ruta \"libros\"\n      location.reload();\n      this.$router.push({ name: \"libros\" });\n    }\n   else {\n        // Muestra el modal de error de inicio de sesión\n        this.showErrorModal();\n      }\n  } catch (error) {\n    // Manejar errores aquí\n    this.showErrorModal();\n    console.error(\"Ocurrió un error:\", error);\n  }\n},\nshowErrorModal() {\n    const errorModal = document.getElementById(\"loginErrorModal\");\n    if (errorModal) {\n      errorModal.classList.add(\"show\");\n      errorModal.style.display = \"block\";\n      errorModal.setAttribute(\"aria-hidden\", \"false\");\n    }\n  },\n  closeErrorModal() {\n    const errorModal = document.getElementById(\"loginErrorModal\");\n    if (errorModal) {\n      errorModal.classList.remove(\"show\");\n      errorModal.style.display = \"none\";\n      errorModal.setAttribute(\"aria-hidden\", \"true\");\n    }\n  },\n  togglePasswordVisibility() {\n    this.showPassword = !this.showPassword;\n    const input = document.querySelector('.input_pass');\n    \n    if (input) {\n      if (this.showPassword) {\n        // Si showPassword es verdadero, cambiamos el tipo de entrada a \"text\" para mostrar la contraseña.\n        input.type = 'text';\n      } else {\n        // Si showPassword es falso, volvemos a cambiar el tipo de entrada a \"password\" para ocultar la contraseña.\n        input.type = 'password';\n      }\n    }\n  },\n  },\n};\n</script>\n\n<style>\n\n.todo{\n\n  /* centrar vertical y horizontalmente */\n  position: absolute;\n  top: 40%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n.grupoInicio {\n    position: relative;\n  }\n\n  .ojo {\n    z-index: 10;\n    position: absolute;\n    right: 0;\n    top: 0;\n    height: 100%;\n    border: none;\n    background-color: transparent;\n  }\n\n.user_card {\n  height: 400px;\n  width: 350px;\n  margin-top: auto;\n  margin-bottom: auto;\n  background: rgb(51, 92, 116);\n  position: relative;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n \n  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\n  -webkit-box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2),\n    0 6px 20px 0 rgba(0, 0, 0, 0.19);\n  -moz-box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2),\n    0 6px 20px 0 rgba(0, 0, 0, 0.19);\n  border-radius: 5px;\n}\n.brand_logo_container {\n  position: absolute;\n  height: 170px;\n  width: 170px;\n  top: -75px;\n  border-radius: 50%;\n  background: #074366;\n  padding: 10px;\n  text-align: center;\n}\n.brand_logo {\n  height: 150px;\n  width: 150px;\n  border-radius: 50%;\n  border: 2px solid white;\n}\n.form_container {\n  margin-top: 100px;\n}\n.login_btn {\n  width: 100%;\n  background: #074366 !important;\n  color: white !important;\n}\n.login_btn:focus {\n  box-shadow: none !important;\n  outline: 0px !important;\n}\n.login_container {\n  padding: 0 2rem;\n}\n.input-group-text {\n  background: #074366 !important;\n  color: white !important;\n  border: 0 !important;\n  border-radius: 0.25rem 0 0 0.25rem !important;\n  height: 100%;\n}\n.input_user,\n.input_pass:focus {\n  box-shadow: none !important;\n  outline: 0px !important;\n}\n.input_pass {\n    border-top-right-radius: 10;\n    border-bottom-right-radius: 10;\n  }\n</style>\n"]},"metadata":{},"sourceType":"module"}