{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      estado: -1,\n      solicitudes: [],\n      libros: [],\n      preTitulo: {},\n      usuario: {\n        cod_alum: localStorage.getItem(\"cod_alum\"),\n        nombre: localStorage.getItem(\"nombre\"),\n        apellidoP: localStorage.getItem(\"ap_paterno\"),\n        apellidoM: localStorage.getItem(\"ap_materno\"),\n        ci_pasaporte: localStorage.getItem(\"ci_pasaporte\")\n      },\n      solicitudesFiltradas: [],\n      elementosPorPagina: 8,\n      datosPaginados: [],\n      paginaActual: 1\n    };\n  },\n\n  mounted() {\n    this.obtenersolicitudes();\n  },\n\n  methods: {\n    obtenersolicitudes() {\n      fetch(RUTA_SERVIDOR_LIBROS + \"/prestamos/\" + this.usuario.cod_alum).then(respuesta => respuesta.json()).then(datosRespuesta => {\n        this.solicitudes = datosRespuesta.reverse();\n      }).then(this.filtrarSolicitudes).catch(console.log);\n    },\n\n    filtrarSolicitudes() {\n      if (this.estado == -1) {\n        this.solicitudesFiltradas = this.solicitudes;\n        this.ObtenerDatosPag(1);\n      } else {\n        this.solicitudesFiltradas = [];\n\n        for (let index = 0; index < this.solicitudes.length; index++) {\n          if (this.solicitudes[index].estado === parseInt(this.estado)) {\n            this.solicitudesFiltradas.push(this.solicitudes[index]);\n            this.ObtenerDatosPag(1);\n          }\n        }\n\n        if (this.solicitudesFiltradas.length === 0) {\n          this.paginaPrevia();\n        }\n      }\n    },\n\n    totalPaginas() {\n      return Math.ceil(this.solicitudesFiltradas.length / this.elementosPorPagina);\n    },\n\n    ObtenerDatosPag(noPag) {\n      this.paginaActual = noPag;\n      this.datosPaginados = [];\n      let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n      let fin = noPag * this.elementosPorPagina;\n      this.datosPaginados = this.solicitudesFiltradas.slice(ini, fin);\n    },\n\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n\n    eliminarSolicitud(solicitud) {\n      console.log(solicitud);\n      axios.put(RUTA_SERVIDOR_LIBROS + \"/prestamos/\" + solicitud.id, {\n        idEmpleado: solicitud.idEmpleado,\n        codigoUsuario: solicitud.codigoUsuario,\n        idLibro: solicitud.idLibro,\n        idSubsede: solicitud.idSubsede,\n        cantidad: solicitud.cantidad,\n        fechaPrestamo: solicitud.fechaPrestamo,\n        fechaDevolucion: solicitud.fechaDevolucion,\n        observacion: \"Prestamo cancelado por el alumno\",\n        estado: solicitud.estado,\n        activo: 0,\n        telefono: solicitud.telefono\n      }).then(function (response) {\n        console.log(response);\n        location.reload();\n      }).catch(function (error) {\n        console.log(error); // console.log(this.libro);\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":";AA0FA;AACA;AAEA;AACA;EACAA;IACA;MACAC,UADA;MAEAC,eAFA;MAGAC,UAHA;MAIAC,aAJA;MAKAC;QACAC,0CADA;QAEAC,sCAFA;QAGAC,6CAHA;QAIAC,6CAJA;QAKAC;MALA,CALA;MAYAC,wBAZA;MAaAC,qBAbA;MAcAC,kBAdA;MAeAC;IAfA;EAiBA,CAnBA;;EAoBAC;IACA;EACA,CAtBA;;EAwBAC;IACAC;MACAC,oEACAC,IADA,CACAC,6BADA,EAEAD,IAFA,CAEAE;QACA;MACA,CAJA,EAKAF,IALA,CAKA,uBALA,EAMAG,KANA,CAMAC,WANA;IAOA,CATA;;IAWAC;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;;QACA;UACA;YACA;YACA;UACA;QACA;;QACA;UACA;QACA;MACA;IACA,CA3BA;;IA4BAC;MACA,iBACA,0DADA;IAGA,CAhCA;;IAiCAC;MACA;MACA;MACA;MACA;MACA;IACA,CAvCA;;IAwCAC;MACA;QACA;MACA;;MACA;IACA,CA7CA;;IA8CAC;MACA;QACA;MACA;;MACA;IACA,CAnDA;;IAoDAC;MACA;IACA,CAtDA;;IAuDAC;MACAP;MACAQ,MACAC,GADA,CACAC,mDADA,EACA;QACAC,gCADA;QAEAC,sCAFA;QAGAC,0BAHA;QAIAC,8BAJA;QAKAC,4BALA;QAMAC,sCANA;QAOAC,0CAPA;QAQAC,+CARA;QASAxC,wBATA;QAUA4B,SAVA;QAWAa;MAXA,CADA,EAcAvB,IAdA,CAcA;QACAI;QACAoB;MACA,CAjBA,EAkBArB,KAlBA,CAkBA;QACAC,mBADA,CAEA;MACA,CArBA;IAsBA;;EA/EA;AAxBA","names":["data","estado","solicitudes","libros","preTitulo","usuario","cod_alum","nombre","apellidoP","apellidoM","ci_pasaporte","solicitudesFiltradas","elementosPorPagina","datosPaginados","paginaActual","mounted","methods","obtenersolicitudes","fetch","then","respuesta","datosRespuesta","catch","console","filtrarSolicitudes","totalPaginas","ObtenerDatosPag","paginaPrevia","paginaSiguiente","activo","eliminarSolicitud","axios","put","RUTA_SERVIDOR_LIBROS","idEmpleado","codigoUsuario","idLibro","idSubsede","cantidad","fechaPrestamo","fechaDevolucion","observacion","telefono","location"],"sourceRoot":"src/components","sources":["ListasolicitudesComponent.vue"],"sourcesContent":["<template>\n  <div class=\"px-md-5 px-2\">\n    Mis Solicitudes\n    <div class=\"form-group text-center\">\n      <label>Seleccione el estado del prestamo</label><br />\n      <select\n        v-model=\"estado\"\n        @change=\"filtrarSolicitudes()\"\n        class=\"custom-select\"\n        name=\"\"\n        id=\"\"\n      >\n        <option value=\"-1\">Todos los estados</option>\n        <option value=\"0\">Solicitud rechazada</option>\n        <option value=\"1\">Pendiente de respuesta</option>\n        <option value=\"2\">Solicitud aceptada</option>\n        <option value=\"3\">libro devuelto</option>\n        <option value=\"4\">Pendiente de devolucion</option>\n      </select>\n    </div>\n    <br>\n    <div class=\"table-responsive\">\n\n    \n    <table class=\"table  table-striped border text-center tableMb\">\n      <thead class=\"thMb\">\n        <tr class=\"trMb\">\n          <th>Libro solicitado</th>\n          <th>Cantidad</th>\n          <th>Fecha de prestamo</th>\n          <th>Fecha de devolución</th>\n          <th>estado</th>\n          <th>Acción</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr class=\"trMb\" v-for=\"solicitud in datosPaginados\" :key=\"solicitud.id\">\n          <td data-titulo=\"Libro solicitado: \">{{ solicitud.titulo }}</td>\n\n          <td data-titulo=\"Cantidad: \">{{ solicitud.cantidad }}</td>\n          <td data-titulo=\"Fecha de prestamo: \">{{ solicitud.fechaPrestamo }}</td>\n          <td data-titulo=\"Fecha de devolución: \">{{ solicitud.fechaDevolucion }}</td>\n          <td data-titulo=\"Estado:\">\n            <p v-if=\"solicitud.estado == 0\" style=\"background: red\">\n              Solicitud rechazada\n            </p>\n            <p v-if=\"solicitud.estado == 1\">Pendiente de respuesta</p>\n            <p v-if=\"solicitud.estado == 2\" style=\"background: green\">\n              Solicitud aceptada\n            </p>\n            <p v-if=\"solicitud.estado == 3\">libro devuelto</p>\n            <p v-if=\"solicitud.estado == 4\">Pendiente de devolucion</p>\n          </td>\n          <td data-titulo=\"Acción: \" v-if=\"solicitud.estado == 1 || solicitud.estado == 2\">\n            <a\n              @click=\"eliminarSolicitud(solicitud)\"\n              class=\"btn btn-primary\"\n              role=\"button\"\n              >Cancelar prestamo</a\n            >\n          </td>\n          <td data-titulo=\"Acción: \"  v-else>No hay accion disponible</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n    <nav aria-label=\"Page navigation example\">\n      <ul align=\"center\" class=\"pagination\">\n        <li class=\"page-item\" v-on:click=\"paginaPrevia()\">\n          <a class=\"page-link\" href=\"#\">Previous</a>\n        </li>\n        <li\n          v-for=\"pagina in totalPaginas()\"\n          :key=\"pagina\"\n          class=\"page-item\"\n          v-bind:class=\"activo(pagina)\"\n        >\n          <a class=\"page-link\" href=\"#\" v-on:click=\"ObtenerDatosPag(pagina)\">{{\n            pagina\n          }}</a>\n        </li>\n        <li class=\"page-item\" v-on:click=\"paginaSiguiente()\">\n          <a class=\"page-link\" href=\"#\">Next</a>\n        </li>\n      </ul>\n    </nav>\n  </div>\n</template>\n\n<script>\n  export const RUTA_SERVIDOR_ALUMNOS = process.env.VUE_APP_RUTA_API_ALUMNOS;\nexport const RUTA_SERVIDOR_LIBROS = process.env.VUE_APP_RUTA_API_LIBROS;\n\nimport axios from \"axios\";\nexport default {\n  data() {\n    return {\n      estado: -1,\n      solicitudes: [],\n      libros: [],\n      preTitulo: {},\n      usuario: {\n        cod_alum: localStorage.getItem(\"cod_alum\"),\n        nombre: localStorage.getItem(\"nombre\"),\n        apellidoP: localStorage.getItem(\"ap_paterno\"),\n        apellidoM: localStorage.getItem(\"ap_materno\"),\n        ci_pasaporte: localStorage.getItem(\"ci_pasaporte\"),\n      },\n      solicitudesFiltradas: [],\n      elementosPorPagina: 8,\n      datosPaginados: [],\n      paginaActual: 1,\n    };\n  },\n  mounted() {\n    this.obtenersolicitudes();\n  },\n\n  methods: {\n    obtenersolicitudes() {\n      fetch(RUTA_SERVIDOR_LIBROS+\"/prestamos/\" + this.usuario.cod_alum)\n        .then((respuesta) => respuesta.json())\n        .then((datosRespuesta) => {\n          this.solicitudes = datosRespuesta.reverse();\n        })\n        .then(this.filtrarSolicitudes)\n        .catch(console.log);\n    },\n\n    filtrarSolicitudes() {\n      if (this.estado == -1) {\n        this.solicitudesFiltradas = this.solicitudes;\n        this.ObtenerDatosPag(1);\n      } else {\n        this.solicitudesFiltradas = [];\n        for (let index = 0; index < this.solicitudes.length; index++) {\n          if (this.solicitudes[index].estado === parseInt(this.estado)) {\n            this.solicitudesFiltradas.push(this.solicitudes[index]);\n            this.ObtenerDatosPag(1);\n          }\n        }\n        if (this.solicitudesFiltradas.length === 0) {\n          this.paginaPrevia();\n        }\n      }\n    },\n    totalPaginas() {\n      return Math.ceil(\n        this.solicitudesFiltradas.length / this.elementosPorPagina\n      );\n    },\n    ObtenerDatosPag(noPag) {\n      this.paginaActual = noPag;\n      this.datosPaginados = [];\n      let ini = noPag * this.elementosPorPagina - this.elementosPorPagina;\n      let fin = noPag * this.elementosPorPagina;\n      this.datosPaginados = this.solicitudesFiltradas.slice(ini, fin);\n    },\n    paginaPrevia() {\n      if (this.paginaActual > 1) {\n        this.paginaActual--;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    paginaSiguiente() {\n      if (this.paginaActual < this.totalPaginas()) {\n        this.paginaActual++;\n      }\n      this.ObtenerDatosPag(this.paginaActual);\n    },\n    activo(noPoag) {\n      return noPoag === this.paginaActual ? \"active\" : \"\";\n    },\n    eliminarSolicitud(solicitud) {\n      console.log(solicitud);\n      axios\n        .put(RUTA_SERVIDOR_LIBROS+\"/prestamos/\" + solicitud.id, {\n          idEmpleado: solicitud.idEmpleado,\n          codigoUsuario: solicitud.codigoUsuario,\n          idLibro: solicitud.idLibro,\n          idSubsede:solicitud.idSubsede,\n          cantidad: solicitud.cantidad,\n          fechaPrestamo: solicitud.fechaPrestamo,\n          fechaDevolucion: solicitud.fechaDevolucion,\n          observacion: \"Prestamo cancelado por el alumno\",\n          estado: solicitud.estado,\n          activo: 0,\n          telefono:solicitud.telefono,\n        })\n        .then(function (response) {\n          console.log(response);\n          location.reload();\n        })\n        .catch(function (error) {\n          console.log(error);\n          // console.log(this.libro);\n        });\n    },\n  },\n};\n</script>\n\n<style>\n@media (max-width:30em){\n  .tableMb{\n    width: 100%;\n    align-content: flex-end;\n  }\n  .trMb{\n    display: flex;\n    flex-direction: column;\n    border: 1px solid;\n    margin-bottom: 1em;\n  }\n  .thMb{\n    display: none;\n  }\n  .tableMb td[data-titulo]{\n      display:flex;\n\n  }\n  .tableMb td[data-titulo]::before{\n      content:attr(data-titulo);\n      width: 200px;\n      \n  }\n \n}\n\n</style>\n"]},"metadata":{},"sourceType":"module"}